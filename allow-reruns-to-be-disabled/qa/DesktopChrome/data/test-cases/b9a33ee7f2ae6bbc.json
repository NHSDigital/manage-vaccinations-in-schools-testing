{"uid":"b9a33ee7f2ae6bbc","name":"test_parent_provides_consent_twice","fullName":"tests.test_verbal_consent#test_parent_provides_consent_twice","historyId":"61a26ab8be1cb375e8f6067f031524f7","time":{"start":1760702195914,"stop":1760702204340,"duration":8426},"description":"\nTest: Record two consents from the same parent (positive then refusal)\n   and verify activity log.\nSteps:\n1. Open the session and consent tab for the child.\n2. Record a written positive consent for parent 1.\n3. Record a triage outcome as safe to vaccinate.\n4. Record a verbal refusal for the same parent.\n5. Check the consent refused text and session activity log.\nVerification:\n- Consent refused text is shown for the parent.\n- Activity log contains entries for refusal, triage, and initial consent.\n","descriptionHtml":"<p>Test: Record two consents from the same parent (positive then refusal)<br />\nand verify activity log.<br />\nSteps:</p>\n<ol>\n<li>Open the session and consent tab for the child.</li>\n<li>Record a written positive consent for parent 1.</li>\n<li>Record a triage outcome as safe to vaccinate.</li>\n<li>Record a verbal refusal for the same parent.</li>\n<li>Check the consent refused text and session activity log.<br />\nVerification:</li>\n</ol>\n<ul>\n<li>Consent refused text is shown for the parent.</li>\n<li>Activity log contains entries for refusal, triage, and initial consent.</li>\n</ul>\n","status":"broken","statusMessage":"playwright._impl._errors.Error: Locator.check: Error: strict mode violation: get_by_role(\"checkbox\", name=\"Consent given\") resolved to 2 elements:\n    1) <input type=\"checkbox\" value=\"given_injection\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-injection-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for injected\")\n    2) <input type=\"checkbox\" value=\"given_nasal\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-nasal-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for nasal spray\")\n\nCall log:\n  - waiting for get_by_role(\"checkbox\", name=\"Consent given\")","statusTrace":"setup_fixed_child = None\nsessions_page = <mavis.test.pages.sessions.SessionsPage object at 0x7fe56cf19010>\nschools = {'HPV': [School(name='Glendinning Academy', urn='147840', site=None), School(name='Testwood School', urn='137315', sit...ngland Primary School\", urn='120153', site=None), School(name='East Rainton Primary School', urn='108794', site=None)]}\nverbal_consent_page = <mavis.test.pages.verbal_consent.VerbalConsentPage object at 0x7fe56c23ebe0>\nchildren = {'HPV': [Child(first_name='Caroline', last_name='PALMER', nhs_number='9483141559', address=('Studio 57', 'Mandy shoals...gracesmith@example.net'), Parent(full_name='Janet Fry', relationship='Mum', email_address='jakefowler@example.net')))]}\n\n    @pytest.mark.bug\n    def test_parent_provides_consent_twice(\n        setup_fixed_child,\n        sessions_page,\n        schools,\n        verbal_consent_page,\n        children,\n    ):\n        \"\"\"\n        Test: Record two consents from the same parent (positive then refusal)\n           and verify activity log.\n        Steps:\n        1. Open the session and consent tab for the child.\n        2. Record a written positive consent for parent 1.\n        3. Record a triage outcome as safe to vaccinate.\n        4. Record a verbal refusal for the same parent.\n        5. Check the consent refused text and session activity log.\n        Verification:\n        - Consent refused text is shown for the parent.\n        - Activity log contains entries for refusal, triage, and initial consent.\n        \"\"\"\n        child = children[Programme.HPV][0]\n        school = schools[Programme.HPV][0]\n    \n        sessions_page.click_session_for_programme_group(school, Programme.HPV)\n        sessions_page.click_consent_tab()\n        sessions_page.select_no_response()\n    \n        sessions_page.navigate_to_consent_response(child, Programme.HPV)\n        verbal_consent_page.select_parent(child.parents[0])\n        verbal_consent_page.select_consent_method(ConsentMethod.PAPER)\n        verbal_consent_page.record_parent_positive_consent(yes_to_health_questions=True)\n>       sessions_page.select_consent_given()\n\ntests/test_verbal_consent.py:202: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/annotations.py:35: in wrapper\n    return_value = func(self, *args, **kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmavis/test/pages/sessions.py:253: in select_consent_given\n    self.consent_given_checkbox.check()\n.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py:15451: in check\n    self._sync(\n.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py:145: in check\n    return await self._frame.check(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py:829: in check\n    await self._channel.send(\"check\", self._timeout, locals_to_params(locals()))\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:69: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7fe578b723c0>\ncb = <function Channel.send.<locals>.<lambda> at 0x7fe56c1ee980>\nis_internal = False, title = None\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(\n            task, \"__pw_stack__\", None\n        ) or inspect.stack(0)\n    \n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.Error: Locator.check: Error: strict mode violation: get_by_role(\"checkbox\", name=\"Consent given\") resolved to 2 elements:\nE               1) <input type=\"checkbox\" value=\"given_injection\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-injection-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for injected\")\nE               2) <input type=\"checkbox\" value=\"given_nasal\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-nasal-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for nasal spray\")\nE           \nE           Call log:\nE             - waiting for get_by_role(\"checkbox\", name=\"Consent given\")\n\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:558: Error","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_verify_url","time":{"start":1760701735610,"stop":1760701735611,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1760701735610,"stop":1760701735610,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1760701735611,"stop":1760701735615,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"year_groups","time":{"start":1760701735615,"stop":1760701735615,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1760701735615,"stop":1760701735615,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1760701735615,"stop":1760701735615,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"onboarding","time":{"start":1760701735616,"stop":1760701747297,"duration":11681},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"programmes_enabled","time":{"start":1760701735616,"stop":1760701735616,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests","time":{"start":1760701747297,"stop":1760701747297,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"team","time":{"start":1760701747297,"stop":1760701747297,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"nurse","time":{"start":1760701747297,"stop":1760701747297,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1760701747297,"stop":1760701747298,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1760701747298,"stop":1760701747639,"duration":341},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"device","time":{"start":1760701747639,"stop":1760701747639,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1760701747639,"stop":1760701747640,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1760701747640,"stop":1760701747640,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1760701747640,"stop":1760701747761,"duration":121},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connect_options","time":{"start":1760701747640,"stop":1760701747640,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder","time":{"start":1760701747762,"stop":1760701747762,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1760701747763,"stop":1760701747764,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_credentials","time":{"start":1760701747764,"stop":1760701747764,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1760701747764,"stop":1760701747764,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_token","time":{"start":1760701747764,"stop":1760701747764,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"schools","time":{"start":1760701849334,"stop":1760701849334,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"organisation","time":{"start":1760701849334,"stop":1760701849334,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clinics","time":{"start":1760701849334,"stop":1760701849334,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"reset_before_each_module","time":{"start":1760702064929,"stop":1760702065741,"duration":812},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1760702180115,"stop":1760702180122,"duration":7},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"output_path","time":{"start":1760702180115,"stop":1760702180115,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context","time":{"start":1760702180115,"stop":1760702180115,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder","time":{"start":1760702180115,"stop":1760702180115,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1760702180122,"stop":1760702180155,"duration":33},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"flipper_page","time":{"start":1760702180155,"stop":1760702180155,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags","time":{"start":1760702180155,"stop":1760702180156,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_page","time":{"start":1760702180156,"stop":1760702180156,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_as_nurse","time":{"start":1760702180156,"stop":1760702182046,"duration":1890},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1760702180156,"stop":1760702180996,"duration":840},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1760702180156,"stop":1760702180996,"duration":840},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='rhamilton@example.org', password='rhamilton@example.org', role='nurse') and choose team Team(name='Wilson, King and Campbell est. 1627', workgroup='Z742E', careplus_venue_code='Z742E', email='readlinda@example.net', phone='+44(0)7700 900 128')","time":{"start":1760702180996,"stop":1760702182046,"duration":1050},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1760702180996,"stop":1760702182046,"duration":1050},"status":"passed","steps":[{"name":"Log in as User(username='rhamilton@example.org', password='rhamilton@example.org', role='nurse')","time":{"start":1760702180996,"stop":1760702182013,"duration":1017},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1760702180996,"stop":1760702182013,"duration":1017},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='rhamilton@example.org', password='rhamilton@example.org', role='nurse'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='rhamilton@example.org', password='rhamilton@example.org', role='nurse'), Team(name='Wilson, King and Campbell est. 1627', workgroup='Z742E', careplus_venue_code='Z742E', email='readlinda@example.net', phone='+44(0)7700 900 128'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"dashboard_page","time":{"start":1760702182046,"stop":1760702182046,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"children","time":{"start":1760702182046,"stop":1760702182052,"duration":6},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data","time":{"start":1760702182052,"stop":1760702182053,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"sessions_page","time":{"start":1760702182053,"stop":1760702182055,"duration":2},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_session_with_file_upload","time":{"start":1760702182055,"stop":1760702182056,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"import_records_page","time":{"start":1760702182055,"stop":1760702182055,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_fixed_child","time":{"start":1760702182056,"stop":1760702195913,"duration":13857},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1760702182056,"stop":1760702183118,"duration":1062},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1760702182056,"stop":1760702183118,"duration":1062},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' session at School(name='Glendinning Academy', urn='147840', site=None)","time":{"start":1760702183119,"stop":1760702183831,"duration":712},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1760702183119,"stop":1760702183831,"duration":712},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='Glendinning Academy', urn='147840', site=None), <Programme.HPV: 'HPV'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1760702183836,"stop":1760702184013,"duration":177},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1760702183836,"stop":1760702184013,"duration":177},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1760702184014,"stop":1760702184271,"duration":257},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1760702184014,"stop":1760702184271,"duration":257},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' session at School(name='Glendinning Academy', urn='147840', site=None)","time":{"start":1760702184271,"stop":1760702184933,"duration":662},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1760702184271,"stop":1760702184933,"duration":662},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='Glendinning Academy', urn='147840', site=None), <Programme.HPV: 'HPV'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import class lists","time":{"start":1760702184933,"stop":1760702185311,"duration":378},"status":"passed","steps":[{"name":"Click on Import class lists","time":{"start":1760702184933,"stop":1760702185311,"duration":378},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702185356,"stop":1760702185821,"duration":465},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702185357,"stop":1760702185821,"duration":464},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Set input file to PosixPath('working/CohortsFileMapping.FIXED_CHILD20251017125625.csv')","time":{"start":1760702185832,"stop":1760702185849,"duration":17},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1760702185832,"stop":1760702185849,"duration":17},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(PosixPath('working/CohortsFileMapping.FIXED_CHILD20251017125625.csv'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702185849,"stop":1760702186184,"duration":335},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702185849,"stop":1760702186184,"duration":335},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"_coverage","value":"None"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click link with uploaded datetime","time":{"start":1760702186212,"stop":1760702186641,"duration":429},"status":"passed","steps":[{"name":"Click link with uploaded datetime","time":{"start":1760702186213,"stop":1760702186641,"duration":428},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1760702195529,"stop":1760702195709,"duration":180},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1760702195530,"stop":1760702195709,"duration":179},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1760702195709,"stop":1760702195913,"duration":204},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1760702195709,"stop":1760702195913,"duration":204},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":24,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"verbal_consent_page","time":{"start":1760702195913,"stop":1760702195913,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\nTest: Record two consents from the same parent (positive then refusal)\n   and verify activity log.\nSteps:\n1. Open the session and consent tab for the child.\n2. Record a written positive consent for parent 1.\n3. Record a triage outcome as safe to vaccinate.\n4. Record a verbal refusal for the same parent.\n5. Check the consent refused text and session activity log.\nVerification:\n- Consent refused text is shown for the parent.\n- Activity log contains entries for refusal, triage, and initial consent.\n","status":"broken","statusMessage":"playwright._impl._errors.Error: Locator.check: Error: strict mode violation: get_by_role(\"checkbox\", name=\"Consent given\") resolved to 2 elements:\n    1) <input type=\"checkbox\" value=\"given_injection\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-injection-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for injected\")\n    2) <input type=\"checkbox\" value=\"given_nasal\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-nasal-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for nasal spray\")\n\nCall log:\n  - waiting for get_by_role(\"checkbox\", name=\"Consent given\")","statusTrace":"setup_fixed_child = None\nsessions_page = <mavis.test.pages.sessions.SessionsPage object at 0x7fe56cf19010>\nschools = {'HPV': [School(name='Glendinning Academy', urn='147840', site=None), School(name='Testwood School', urn='137315', sit...ngland Primary School\", urn='120153', site=None), School(name='East Rainton Primary School', urn='108794', site=None)]}\nverbal_consent_page = <mavis.test.pages.verbal_consent.VerbalConsentPage object at 0x7fe56c23ebe0>\nchildren = {'HPV': [Child(first_name='Caroline', last_name='PALMER', nhs_number='9483141559', address=('Studio 57', 'Mandy shoals...gracesmith@example.net'), Parent(full_name='Janet Fry', relationship='Mum', email_address='jakefowler@example.net')))]}\n\n    @pytest.mark.bug\n    def test_parent_provides_consent_twice(\n        setup_fixed_child,\n        sessions_page,\n        schools,\n        verbal_consent_page,\n        children,\n    ):\n        \"\"\"\n        Test: Record two consents from the same parent (positive then refusal)\n           and verify activity log.\n        Steps:\n        1. Open the session and consent tab for the child.\n        2. Record a written positive consent for parent 1.\n        3. Record a triage outcome as safe to vaccinate.\n        4. Record a verbal refusal for the same parent.\n        5. Check the consent refused text and session activity log.\n        Verification:\n        - Consent refused text is shown for the parent.\n        - Activity log contains entries for refusal, triage, and initial consent.\n        \"\"\"\n        child = children[Programme.HPV][0]\n        school = schools[Programme.HPV][0]\n    \n        sessions_page.click_session_for_programme_group(school, Programme.HPV)\n        sessions_page.click_consent_tab()\n        sessions_page.select_no_response()\n    \n        sessions_page.navigate_to_consent_response(child, Programme.HPV)\n        verbal_consent_page.select_parent(child.parents[0])\n        verbal_consent_page.select_consent_method(ConsentMethod.PAPER)\n        verbal_consent_page.record_parent_positive_consent(yes_to_health_questions=True)\n>       sessions_page.select_consent_given()\n\ntests/test_verbal_consent.py:202: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/annotations.py:35: in wrapper\n    return_value = func(self, *args, **kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmavis/test/pages/sessions.py:253: in select_consent_given\n    self.consent_given_checkbox.check()\n.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py:15451: in check\n    self._sync(\n.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py:145: in check\n    return await self._frame.check(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py:829: in check\n    await self._channel.send(\"check\", self._timeout, locals_to_params(locals()))\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:69: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7fe578b723c0>\ncb = <function Channel.send.<locals>.<lambda> at 0x7fe56c1ee980>\nis_internal = False, title = None\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(\n            task, \"__pw_stack__\", None\n        ) or inspect.stack(0)\n    \n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.Error: Locator.check: Error: strict mode violation: get_by_role(\"checkbox\", name=\"Consent given\") resolved to 2 elements:\nE               1) <input type=\"checkbox\" value=\"given_injection\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-injection-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for injected\")\nE               2) <input type=\"checkbox\" value=\"given_nasal\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-nasal-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for nasal spray\")\nE           \nE           Call log:\nE             - waiting for get_by_role(\"checkbox\", name=\"Consent given\")\n\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:558: Error","steps":[{"name":"Click on 'HPV' session at School(name='Glendinning Academy', urn='147840', site=None)","time":{"start":1760702195914,"stop":1760702196396,"duration":482},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1760702195914,"stop":1760702196396,"duration":482},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='Glendinning Academy', urn='147840', site=None), <Programme.HPV: 'HPV'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Consent tab","time":{"start":1760702196396,"stop":1760702196638,"duration":242},"status":"passed","steps":[{"name":"Click on Consent tab","time":{"start":1760702196396,"stop":1760702196638,"duration":242},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select No response","time":{"start":1760702196638,"stop":1760702196895,"duration":257},"status":"passed","steps":[{"name":"Select No response","time":{"start":1760702196638,"stop":1760702196895,"duration":257},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on child Child(first_name='Caroline', last_name='PALMER', nhs_number='9483141559', address=('Studio 57', 'Mandy shoals', 'Wardstad', 'S8D 7NY'), date_of_birth=datetime.date(2011, 6, 22), year_group=10, parents=(Parent(full_name='Declan Simpson', relationship='Dad', email_address='ndavies@example.net'), Parent(full_name='Emma Williams', relationship='Mum', email_address='harveykirsty@example.net')))","time":{"start":1760702196895,"stop":1760702197122,"duration":227},"status":"passed","steps":[{"name":"Click on child {1}","time":{"start":1760702196895,"stop":1760702197122,"duration":227},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(Child(first_name='Caroline', last_name='PALMER', nhs_number='9483141559', address=('Studio 57', 'Mandy shoals', 'Wardstad', 'S8D 7NY'), date_of_birth=datetime.date(2011, 6, 22), year_group=10, parents=(Parent(full_name='Declan Simpson', relationship='Dad', email_address='ndavies@example.net'), Parent(full_name='Emma Williams', relationship='Mum', email_address='harveykirsty@example.net'))),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' tab","time":{"start":1760702197122,"stop":1760702197462,"duration":340},"status":"passed","steps":[{"name":"Click on {1} tab","time":{"start":1760702197122,"stop":1760702197462,"duration":340},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<Programme.HPV: 'HPV'>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Record a new consent response","time":{"start":1760702197462,"stop":1760702199014,"duration":1552},"status":"passed","steps":[{"name":"Click on Record a new consent response","time":{"start":1760702197462,"stop":1760702199014,"duration":1552},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'Declan Simpson (Dad)' radio button","time":{"start":1760702199014,"stop":1760702199073,"duration":59},"status":"passed","steps":[{"name":"Click on {1} radio button","time":{"start":1760702199014,"stop":1760702199073,"duration":59},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"('Declan Simpson (Dad)',)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702199073,"stop":1760702199642,"duration":569},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702199073,"stop":1760702199642,"duration":569},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702199642,"stop":1760702200583,"duration":941},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702199642,"stop":1760702200583,"duration":941},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select consent method","time":{"start":1760702200583,"stop":1760702200639,"duration":56},"status":"passed","steps":[{"name":"Select consent method","time":{"start":1760702200583,"stop":1760702200639,"duration":56},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<ConsentMethod.PAPER: 'Paper'>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702200639,"stop":1760702201024,"duration":385},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702200639,"stop":1760702201024,"duration":385},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Yes, they agree","time":{"start":1760702201024,"stop":1760702201073,"duration":49},"status":"passed","steps":[{"name":"Click on Yes, they agree","time":{"start":1760702201024,"stop":1760702201073,"duration":49},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702201073,"stop":1760702201688,"duration":615},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702201073,"stop":1760702201688,"duration":615},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select 'Yes' for health question 'Does your child have any severe allergies?'","time":{"start":1760702201689,"stop":1760702201748,"duration":59},"status":"passed","steps":[{"name":"Select {2} for health question {1}","time":{"start":1760702201689,"stop":1760702201748,"duration":59},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<HealthQuestion.SEVERE_ALLERGIES: 'Does your child have any severe allergies?'>, 'Yes')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select 'Yes' for health question 'Does your child have any medical conditions for which they receive treatment?'","time":{"start":1760702201748,"stop":1760702201796,"duration":48},"status":"passed","steps":[{"name":"Select {2} for health question {1}","time":{"start":1760702201748,"stop":1760702201796,"duration":48},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<HealthQuestion.MEDICAL_CONDITIONS: 'Does your child have any medical conditions for which they receive treatment?'>, 'Yes')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select 'Yes' for health question 'Has your child ever had a severe reaction to any medicines, including vaccines?'","time":{"start":1760702201796,"stop":1760702201847,"duration":51},"status":"passed","steps":[{"name":"Select {2} for health question {1}","time":{"start":1760702201796,"stop":1760702201847,"duration":51},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<HealthQuestion.REACTION: 'Has your child ever had a severe reaction to any medicines, including vaccines?'>, 'Yes')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select 'Yes' for health question 'Does your child need extra support during vaccination sessions?'","time":{"start":1760702201847,"stop":1760702201896,"duration":49},"status":"passed","steps":[{"name":"Select {2} for health question {1}","time":{"start":1760702201847,"stop":1760702201896,"duration":49},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<HealthQuestion.EXTRA_SUPPORT: 'Does your child need extra support during vaccination sessions?'>, 'Yes')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702201896,"stop":1760702202578,"duration":682},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702201896,"stop":1760702202578,"duration":682},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Yes, it’s safe to vaccinate","time":{"start":1760702202579,"stop":1760702202622,"duration":43},"status":"passed","steps":[{"name":"Click on Yes, it’s safe to vaccinate","time":{"start":1760702202579,"stop":1760702202622,"duration":43},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"programme","value":"'HPV'"},{"name":"consent_option","value":"'Injection'"},{"name":"psd_option","value":"None"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1760702202623,"stop":1760702202998,"duration":375},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1760702202623,"stop":1760702202998,"duration":375},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Confirm","time":{"start":1760702202998,"stop":1760702203829,"duration":831},"status":"passed","steps":[{"name":"Click Confirm","time":{"start":1760702202998,"stop":1760702203829,"duration":831},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select Consent given","time":{"start":1760702203829,"stop":1760702204339,"duration":510},"status":"broken","statusMessage":"playwright._impl._errors.Error: Locator.check: Error: strict mode violation: get_by_role(\"checkbox\", name=\"Consent given\") resolved to 2 elements:\n    1) <input type=\"checkbox\" value=\"given_injection\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-injection-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for injected\")\n    2) <input type=\"checkbox\" value=\"given_nasal\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-nasal-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for nasal spray\")\n\nCall log:\n  - waiting for get_by_role(\"checkbox\", name=\"Consent given\")\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/allure_commons/_allure.py\", line 202, in impl\n    return func(*a, **kw)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/annotations.py\", line 35, in wrapper\n    return_value = func(self, *args, **kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/sessions.py\", line 253, in select_consent_given\n    self.consent_given_checkbox.check()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 15451, in check\n    self._sync(\n    ~~~~~~~~~~^\n        self._impl_obj.check(\n        ^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n        )\n        ^\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py\", line 145, in check\n    return await self._frame.check(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py\", line 829, in check\n    await self._channel.send(\"check\", self._timeout, locals_to_params(locals()))\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 69, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 558, in wrap_api_call\n    raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\n","steps":[{"name":"Select Consent given","time":{"start":1760702203829,"stop":1760702204338,"duration":509},"status":"broken","statusMessage":"playwright._impl._errors.Error: Locator.check: Error: strict mode violation: get_by_role(\"checkbox\", name=\"Consent given\") resolved to 2 elements:\n    1) <input type=\"checkbox\" value=\"given_injection\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-injection-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for injected\")\n    2) <input type=\"checkbox\" value=\"given_nasal\" name=\"consent_statuses[]\" class=\"nhsuk-checkboxes__input\" id=\"consent-statuses-given-nasal-field\"/> aka get_by_role(\"checkbox\", name=\"Consent given for nasal spray\")\n\nCall log:\n  - waiting for get_by_role(\"checkbox\", name=\"Consent given\")\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/annotations.py\", line 35, in wrapper\n    return_value = func(self, *args, **kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/mavis/test/pages/sessions.py\", line 253, in select_consent_given\n    self.consent_given_checkbox.check()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 15451, in check\n    self._sync(\n    ~~~~~~~~~~^\n        self._impl_obj.check(\n        ^^^^^^^^^^^^^^^^^^^^^\n    ...<5 lines>...\n        )\n        ^\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py\", line 145, in check\n    return await self._frame.check(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py\", line 829, in check\n    await self._channel.send(\"check\", self._timeout, locals_to_params(locals()))\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 69, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools-testing/manage-vaccinations-in-schools-testing/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 558, in wrap_api_call\n    raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\n","steps":[],"attachments":[{"uid":"d31fca06037d1a79","name":"Screenshot on failure","source":"d31fca06037d1a79.png","type":"image/png","size":54862}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":44,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"setup_fixed_child::0","time":{"start":1760702204554,"stop":1760702205461,"duration":907},"status":"passed","steps":[{"name":"Go to dashboard","time":{"start":1760702204555,"stop":1760702204714,"duration":159},"status":"passed","steps":[{"name":"Go to dashboard","time":{"start":1760702204555,"stop":1760702204714,"duration":159},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1760702204714,"stop":1760702204891,"duration":177},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1760702204714,"stop":1760702204891,"duration":177},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1760702204891,"stop":1760702205111,"duration":220},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1760702204891,"stop":1760702205111,"duration":220},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"log_in_as_nurse::0","time":{"start":1760702205463,"stop":1760702205884,"duration":421},"status":"passed","steps":[{"name":"Log out","time":{"start":1760702205463,"stop":1760702205884,"duration":421},"status":"passed","steps":[{"name":"Log out","time":{"start":1760702205463,"stop":1760702205884,"duration":421},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"set_feature_flags::0","time":{"start":1760702205885,"stop":1760702205885,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context::0","time":{"start":1760702205886,"stop":1760702205895,"duration":9},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder::0","time":{"start":1760702205895,"stop":1760702205895,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder::0","time":{"start":1760702377863,"stop":1760702377864,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1760702377864,"stop":1760702377909,"duration":45},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1760702377911,"stop":1760702377926,"duration":15},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests::0","time":{"start":1760702377929,"stop":1760702378592,"duration":663},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"bug"},{"name":"tag","value":"consent"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_verbal_consent"},{"name":"host","value":"runnervmwhb2z"},{"name":"thread","value":"2176-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_verbal_consent"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[],"categories":[{"name":"Test defects","matchedStatuses":[]}],"tags":["bug","consent"]},"source":"b9a33ee7f2ae6bbc.json","parameterValues":[]}