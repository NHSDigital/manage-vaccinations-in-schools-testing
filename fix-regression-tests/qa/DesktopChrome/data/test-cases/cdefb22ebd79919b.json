{"uid":"cdefb22ebd79919b","name":"test_vaccination_file_upload_whitespace_normalization","fullName":"tests.test_import_vaccinations#test_vaccination_file_upload_whitespace_normalization","historyId":"5e2764231c12a9d438c80b8583dcbca8","time":{"start":1761836728396,"stop":1761836764507,"duration":36111},"description":"\nTest: Upload a vaccination records file with extra whitespace and\n   verify normalization.\nSteps:\n1. Upload a file with whitespace issues.\n2. Navigate to children page.\n3. Verify the list is normalized and imported correctly.\nVerification:\n- Imported list matches expected normalized data.\n","descriptionHtml":"<p>Test: Upload a vaccination records file with extra whitespace and<br />\nverify normalization.<br />\nSteps:</p>\n<ol>\n<li>Upload a file with whitespace issues.</li>\n<li>Navigate to children page.</li>\n<li>Verify the list is normalized and imported correctly.<br />\nVerification:</li>\n</ol>\n<ul>\n<li>Imported list matches expected normalized data.</li>\n</ul>\n","status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for get_by_role(\"button\", name=\"Search\")\n    - locator resolved to <button type=\"submit\" data-nhsuk-button-init=\"\" data-module=\"nhsuk-button\" class=\"nhsuk-button app-button--icon app-search-input__submit\">…</button>\n  - attempting click action\n    - waiting for element to be visible, enabled and stable\n    - element is visible, enabled and stable\n    - scrolling into view if needed\n    - done scrolling\n    - performing click action\n    - click action done\n    - waiting for scheduled navigations to finish","statusTrace":"setup_vaccs = '1483045'\nimport_records_page = <mavis.test.pages.import_records.ImportRecordsPage object at 0x7f1a1e27d470>\nchildren_page = <mavis.test.pages.children.ChildrenPage object at 0x7f1a26167610>\ndashboard_page = <mavis.test.pages.dashboard.DashboardPage object at 0x7f1a1e27d1d0>\n\n    @pytest.mark.vaccinations\n    @pytest.mark.bug\n    def test_vaccination_file_upload_whitespace_normalization(\n        setup_vaccs,\n        import_records_page,\n        children_page,\n        dashboard_page,\n    ):\n        \"\"\"\n        Test: Upload a vaccination records file with extra whitespace and\n           verify normalization.\n        Steps:\n        1. Upload a file with whitespace issues.\n        2. Navigate to children page.\n        3. Verify the list is normalized and imported correctly.\n        Verification:\n        - Imported list matches expected normalized data.\n        \"\"\"\n        input_file, _ = import_records_page.upload_and_verify_output(\n            VaccsFileMapping.WHITESPACE,\n            session_id=setup_vaccs,\n        )\n        dashboard_page.click_mavis()\n        dashboard_page.click_children()\n>       children_page.verify_list_has_been_uploaded(input_file, is_vaccinations=True)\n\ntests/test_import_vaccinations.py:337: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/children.py:112: in verify_list_has_been_uploaded\n    self.search_with_all_filters_for_child_name(child_name)\nmavis/test/pages/children.py:241: in search_with_all_filters_for_child_name\n    self.search_button.click()\n.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py:15543: in click\n    self._sync(\n.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py:160: in click\n    return await self._frame.click(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py:549: in click\n    await self._channel.send(\"click\", self._timeout, locals_to_params(locals()))\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:69: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7f1a27fada90>\ncb = <function Channel.send.<locals>.<lambda> at 0x7f1a27a38f60>\nis_internal = False, title = None\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(\n            task, \"__pw_stack__\", None\n        ) or inspect.stack(0)\n    \n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nE           Call log:\nE             - waiting for get_by_role(\"button\", name=\"Search\")\nE               - locator resolved to <button type=\"submit\" data-nhsuk-button-init=\"\" data-module=\"nhsuk-button\" class=\"nhsuk-button app-button--icon app-search-input__submit\">…</button>\nE             - attempting click action\nE               - waiting for element to be visible, enabled and stable\nE               - element is visible, enabled and stable\nE               - scrolling into view if needed\nE               - done scrolling\nE               - performing click action\nE               - click action done\nE               - waiting for scheduled navigations to finish\n\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:558: TimeoutError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"_verify_url","time":{"start":1761836458529,"stop":1761836458529,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"base_url","time":{"start":1761836458529,"stop":1761836458529,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1761836458529,"stop":1761836458530,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"year_groups","time":{"start":1761836458531,"stop":1761836458532,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1761836458531,"stop":1761836458531,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1761836458531,"stop":1761836458531,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"programmes_enabled","time":{"start":1761836458532,"stop":1761836458532,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"onboarding","time":{"start":1761836458532,"stop":1761836476226,"duration":17694},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"organisation","time":{"start":1761836476226,"stop":1761836476226,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"schools","time":{"start":1761836476226,"stop":1761836476226,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests","time":{"start":1761836476226,"stop":1761836476226,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clinics","time":{"start":1761836476226,"stop":1761836476226,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"nurse","time":{"start":1761836476226,"stop":1761836476226,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"team","time":{"start":1761836476226,"stop":1761836476226,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1761836476227,"stop":1761836476227,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1761836476227,"stop":1761836476543,"duration":316},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1761836476543,"stop":1761836476544,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"device","time":{"start":1761836476543,"stop":1761836476543,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1761836476544,"stop":1761836476544,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connect_options","time":{"start":1761836476544,"stop":1761836476544,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1761836476544,"stop":1761836476649,"duration":105},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder","time":{"start":1761836476649,"stop":1761836476649,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1761836476649,"stop":1761836476650,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_credentials","time":{"start":1761836476650,"stop":1761836476650,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_token","time":{"start":1761836476650,"stop":1761836476650,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1761836476650,"stop":1761836476650,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"reset_before_each_module","time":{"start":1761836476651,"stop":1761836478707,"duration":2056},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context","time":{"start":1761836718686,"stop":1761836718686,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1761836718686,"stop":1761836718693,"duration":7},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"output_path","time":{"start":1761836718686,"stop":1761836718686,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder","time":{"start":1761836718686,"stop":1761836718686,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1761836718693,"stop":1761836718726,"duration":33},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"flipper_page","time":{"start":1761836718726,"stop":1761836718726,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags","time":{"start":1761836718726,"stop":1761836718726,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_page","time":{"start":1761836718727,"stop":1761836718727,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_as_nurse","time":{"start":1761836718727,"stop":1761836720857,"duration":2130},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1761836718727,"stop":1761836719748,"duration":1021},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1761836718727,"stop":1761836719748,"duration":1021},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='kphillips@example.com', password='kphillips@example.com', role='nurse') and choose team Team(name='Carey-Russell est. 1670', workgroup='H387K', careplus_venue_code='H387K', email='marionedwards@example.net', phone='+44(0)7700 900829')","time":{"start":1761836719748,"stop":1761836720857,"duration":1109},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1761836719748,"stop":1761836720857,"duration":1109},"status":"passed","steps":[{"name":"Log in as User(username='kphillips@example.com', password='kphillips@example.com', role='nurse')","time":{"start":1761836719748,"stop":1761836720826,"duration":1078},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1761836719748,"stop":1761836720826,"duration":1078},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='kphillips@example.com', password='kphillips@example.com', role='nurse'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='kphillips@example.com', password='kphillips@example.com', role='nurse'), Team(name='Carey-Russell est. 1670', workgroup='H387K', careplus_venue_code='H387K', email='marionedwards@example.net', phone='+44(0)7700 900829'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"children","time":{"start":1761836720858,"stop":1761836720863,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"dashboard_page","time":{"start":1761836720858,"stop":1761836720858,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data","time":{"start":1761836720864,"stop":1761836720865,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"sessions_page","time":{"start":1761836720865,"stop":1761836720866,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"import_records_page","time":{"start":1761836720866,"stop":1761836720866,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_vaccs","time":{"start":1761836720866,"stop":1761836728395,"duration":7529},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1761836720866,"stop":1761836721097,"duration":231},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1761836720866,"stop":1761836721097,"duration":231},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' session at School(name='Shire Oak Academy', urn='136620', site=None)","time":{"start":1761836721097,"stop":1761836721666,"duration":569},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1761836721097,"stop":1761836721666,"duration":569},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='Shire Oak Academy', urn='136620', site=None), <Programme.HPV: 'HPV'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import class lists","time":{"start":1761836721671,"stop":1761836722080,"duration":409},"status":"passed","steps":[{"name":"Click on Import class lists","time":{"start":1761836721671,"stop":1761836722080,"duration":409},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761836722138,"stop":1761836722684,"duration":546},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761836722138,"stop":1761836722684,"duration":546},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Set input file to PosixPath('working/ClassFileMapping.RANDOM_CHILD20251030150522.csv')","time":{"start":1761836722702,"stop":1761836722724,"duration":22},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1761836722702,"stop":1761836722723,"duration":21},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(PosixPath('working/ClassFileMapping.RANDOM_CHILD20251030150522.csv'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761836723724,"stop":1761836724095,"duration":371},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761836723724,"stop":1761836724095,"duration":371},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"_coverage","value":"None"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click link with uploaded datetime","time":{"start":1761836724139,"stop":1761836724334,"duration":195},"status":"passed","steps":[{"name":"Click link with uploaded datetime","time":{"start":1761836724139,"stop":1761836724334,"duration":195},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1761836725579,"stop":1761836725770,"duration":191},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1761836725579,"stop":1761836725770,"duration":191},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1761836725770,"stop":1761836725995,"duration":225},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1761836725770,"stop":1761836725995,"duration":225},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' session at School(name='Shire Oak Academy', urn='136620', site=None)","time":{"start":1761836725995,"stop":1761836726561,"duration":566},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1761836725995,"stop":1761836726561,"duration":566},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='Shire Oak Academy', urn='136620', site=None), <Programme.HPV: 'HPV'>)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Record offline","time":{"start":1761836726561,"stop":1761836726840,"duration":279},"status":"passed","steps":[{"name":"Click on Record offline","time":{"start":1761836726561,"stop":1761836726840,"duration":279},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1761836726893,"stop":1761836727074,"duration":181},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1761836726893,"stop":1761836727074,"duration":181},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import Records","time":{"start":1761836727074,"stop":1761836727288,"duration":214},"status":"passed","steps":[{"name":"Click on Import Records","time":{"start":1761836727074,"stop":1761836727288,"duration":214},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import Records","time":{"start":1761836727288,"stop":1761836727803,"duration":515},"status":"passed","steps":[{"name":"Click on Import Records","time":{"start":1761836727288,"stop":1761836727803,"duration":515},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select Vaccination Records","time":{"start":1761836727803,"stop":1761836727853,"duration":50},"status":"passed","steps":[{"name":"Select Vaccination Records","time":{"start":1761836727803,"stop":1761836727853,"duration":50},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761836727853,"stop":1761836728394,"duration":541},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761836727853,"stop":1761836728394,"duration":541},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":32,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"children_page","time":{"start":1761836728395,"stop":1761836728395,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\nTest: Upload a vaccination records file with extra whitespace and\n   verify normalization.\nSteps:\n1. Upload a file with whitespace issues.\n2. Navigate to children page.\n3. Verify the list is normalized and imported correctly.\nVerification:\n- Imported list matches expected normalized data.\n","status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for get_by_role(\"button\", name=\"Search\")\n    - locator resolved to <button type=\"submit\" data-nhsuk-button-init=\"\" data-module=\"nhsuk-button\" class=\"nhsuk-button app-button--icon app-search-input__submit\">…</button>\n  - attempting click action\n    - waiting for element to be visible, enabled and stable\n    - element is visible, enabled and stable\n    - scrolling into view if needed\n    - done scrolling\n    - performing click action\n    - click action done\n    - waiting for scheduled navigations to finish","statusTrace":"setup_vaccs = '1483045'\nimport_records_page = <mavis.test.pages.import_records.ImportRecordsPage object at 0x7f1a1e27d470>\nchildren_page = <mavis.test.pages.children.ChildrenPage object at 0x7f1a26167610>\ndashboard_page = <mavis.test.pages.dashboard.DashboardPage object at 0x7f1a1e27d1d0>\n\n    @pytest.mark.vaccinations\n    @pytest.mark.bug\n    def test_vaccination_file_upload_whitespace_normalization(\n        setup_vaccs,\n        import_records_page,\n        children_page,\n        dashboard_page,\n    ):\n        \"\"\"\n        Test: Upload a vaccination records file with extra whitespace and\n           verify normalization.\n        Steps:\n        1. Upload a file with whitespace issues.\n        2. Navigate to children page.\n        3. Verify the list is normalized and imported correctly.\n        Verification:\n        - Imported list matches expected normalized data.\n        \"\"\"\n        input_file, _ = import_records_page.upload_and_verify_output(\n            VaccsFileMapping.WHITESPACE,\n            session_id=setup_vaccs,\n        )\n        dashboard_page.click_mavis()\n        dashboard_page.click_children()\n>       children_page.verify_list_has_been_uploaded(input_file, is_vaccinations=True)\n\ntests/test_import_vaccinations.py:337: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/children.py:112: in verify_list_has_been_uploaded\n    self.search_with_all_filters_for_child_name(child_name)\nmavis/test/pages/children.py:241: in search_with_all_filters_for_child_name\n    self.search_button.click()\n.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py:15543: in click\n    self._sync(\n.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py:160: in click\n    return await self._frame.click(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py:549: in click\n    await self._channel.send(\"click\", self._timeout, locals_to_params(locals()))\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:69: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7f1a27fada90>\ncb = <function Channel.send.<locals>.<lambda> at 0x7f1a27a38f60>\nis_internal = False, title = None\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(\n            task, \"__pw_stack__\", None\n        ) or inspect.stack(0)\n    \n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nE           Call log:\nE             - waiting for get_by_role(\"button\", name=\"Search\")\nE               - locator resolved to <button type=\"submit\" data-nhsuk-button-init=\"\" data-module=\"nhsuk-button\" class=\"nhsuk-button app-button--icon app-search-input__submit\">…</button>\nE             - attempting click action\nE               - waiting for element to be visible, enabled and stable\nE               - element is visible, enabled and stable\nE               - scrolling into view if needed\nE               - done scrolling\nE               - performing click action\nE               - click action done\nE               - waiting for scheduled navigations to finish\n\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:558: TimeoutError","steps":[{"name":"Set input file to PosixPath('working/VaccsFileMapping.WHITESPACE20251030150528.csv')","time":{"start":1761836728421,"stop":1761836728441,"duration":20},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1761836728421,"stop":1761836728441,"duration":20},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(PosixPath('working/VaccsFileMapping.WHITESPACE20251030150528.csv'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761836729441,"stop":1761836729819,"duration":378},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761836729441,"stop":1761836729819,"duration":378},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"_coverage","value":"'TwoSpaces, Tabs, NBSP, ZWJ'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click link with uploaded datetime","time":{"start":1761836729856,"stop":1761836730086,"duration":230},"status":"passed","steps":[{"name":"Click link with uploaded datetime","time":{"start":1761836729856,"stop":1761836730086,"duration":230},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1761836731925,"stop":1761836732122,"duration":197},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1761836731925,"stop":1761836732122,"duration":197},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Children","time":{"start":1761836732123,"stop":1761836734465,"duration":2342},"status":"passed","steps":[{"name":"Click on Children","time":{"start":1761836732123,"stop":1761836734465,"duration":2342},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":10,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"setup_vaccs::0","time":{"start":1761836764644,"stop":1761836766287,"duration":1643},"status":"passed","steps":[{"name":"Go to dashboard","time":{"start":1761836764644,"stop":1761836765009,"duration":365},"status":"passed","steps":[{"name":"Go to dashboard","time":{"start":1761836764644,"stop":1761836765009,"duration":365},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1761836765009,"stop":1761836765422,"duration":413},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1761836765009,"stop":1761836765422,"duration":413},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1761836765423,"stop":1761836765932,"duration":509},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1761836765423,"stop":1761836765932,"duration":509},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"log_in_as_nurse::0","time":{"start":1761836766289,"stop":1761836766735,"duration":446},"status":"passed","steps":[{"name":"Log out","time":{"start":1761836766289,"stop":1761836766735,"duration":446},"status":"passed","steps":[{"name":"Log out","time":{"start":1761836766289,"stop":1761836766735,"duration":446},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"new_context::0","time":{"start":1761836766736,"stop":1761836766744,"duration":8},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags::0","time":{"start":1761836766736,"stop":1761836766736,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder::0","time":{"start":1761836766745,"stop":1761836766745,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder::0","time":{"start":1761837302030,"stop":1761837302030,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1761837302031,"stop":1761837302056,"duration":25},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1761837302058,"stop":1761837302067,"duration":9},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests::0","time":{"start":1761837302069,"stop":1761837304863,"duration":2794},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"bug"},{"name":"tag","value":"vaccinations"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_import_vaccinations"},{"name":"host","value":"runnervmwhb2z"},{"name":"thread","value":"3108-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_import_vaccinations"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":["vaccinations","bug"]},"source":"cdefb22ebd79919b.json","parameterValues":[]}