{"uid":"ca273e708d9216ae","name":"test_site_child_record_import","fullName":"tests.test_team#test_site_child_record_import","historyId":"599fda6028cbe0b0db4ef761c02c7f69","time":{"start":1769770227363,"stop":1769770259493,"duration":32130},"description":"\nTest: Importing child records for a school that has been split into sites.\nSteps:\n1. From the team page, create a new school site (Site B) for an existing school.\n2. Attempt to import child records using the original school URN.\n3. Update the input file to use a site-specific URN (with an A/B identifier).\n4. Re-run the import and complete the wizard.\n5. Navigate to the original school and the new site Children pages.\nVerification:\n- An error message is shown when using the original URN, instructing the user\n  to use URNs with site identifiers (e.g. {URN}A or {URN}B).\n- The import succeeds when the child record uses a valid site identifier.\n- The imported child appears under the original school site (A).\n- The imported child does not appear under the new school site (B).\n","descriptionHtml":"<p>Test: Importing child records for a school that has been split into sites.<br />\nSteps:</p>\n<ol>\n<li>From the team page, create a new school site (Site B) for an existing school.</li>\n<li>Attempt to import child records using the original school URN.</li>\n<li>Update the input file to use a site-specific URN (with an A/B identifier).</li>\n<li>Re-run the import and complete the wizard.</li>\n<li>Navigate to the original school and the new site Children pages.<br />\nVerification:</li>\n</ol>\n<ul>\n<li>An error message is shown when using the original URN, instructing the user<br />\nto use URNs with site identifiers (e.g. {URN}A or {URN}B).</li>\n<li>The import succeeds when the child record uses a valid site identifier.</li>\n<li>The imported child appears under the original school site (A).</li>\n<li>The imported child does not appear under the new school site (B).</li>\n</ul>\n","status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for get_by_role(\"button\", name=\"Add site\")","statusTrace":"page = <Page url='http://3.8.164.95:4000/draft-school-site/details'>\nlog_in_as_nurse = None\nfile_generator = <mavis.test.data.file_generator.FileGenerator object at 0x7fd87ad98830>\nschools = {'HPV': [School(name='Thames Christian School', urn='132237', site=None, address_line_1='12 Grant Road', address_line_...', site=None, address_line_1='Birchfield Road', address_line_2='', address_town='Widnes', address_postcode='WA8 7TD')]}\nchildren = {'HPV': [Child(first_name='Laura', last_name='ROBERTS', nhs_number='9403972335', address=('Studio 1', 'Lesley Mountain....com'), Parent(full_name='Janice Pugh', relationship=<Relationship.MUM: 'Mum'>, email_address='jsharp@example.net')))]}\n\n    def test_site_child_record_import(\n        page, log_in_as_nurse, file_generator, schools, children\n    ):\n        \"\"\"\n        Test: Importing child records for a school that has been split into sites.\n        Steps:\n        1. From the team page, create a new school site (Site B) for an existing school.\n        2. Attempt to import child records using the original school URN.\n        3. Update the input file to use a site-specific URN (with an A/B identifier).\n        4. Re-run the import and complete the wizard.\n        5. Navigate to the original school and the new site Children pages.\n        Verification:\n        - An error message is shown when using the original URN, instructing the user\n          to use URNs with site identifiers (e.g. {URN}A or {URN}B).\n        - The import succeeds when the child record uses a valid site identifier.\n        - The imported child appears under the original school site (A).\n        - The imported child does not appear under the new school site (B).\n        \"\"\"\n        school = schools[Programme.FLU][0]\n        child = children[Programme.FLU][0]\n    \n        new_site_name = f\"{school} (Site B)\"\n    \n        DashboardPage(page).click_your_team()\n        TeamContactDetailsPage(page).links.click_schools()\n        TeamSchoolsPage(page).click_add_new_school_site()\n        TeamSchoolsPage(page).select_school(school)\n        TeamSchoolsPage(page).fill_site_name(new_site_name)\n        TeamSchoolsPage(page).click_continue()\n>       TeamSchoolsPage(page).confirm_site()\n\ntests/test_team.py:119: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/annotations.py:50: in wrapper\n    return_value = func(*args, **kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^\nmavis/test/pages/team/team_schools_page.py:126: in confirm_site\n    self.confirm_site_button.click()\n.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py:15637: in click\n    self._sync(\n.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py:162: in click\n    return await self._frame._click(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py:566: in _click\n    await self._channel.send(\"click\", self._timeout, locals_to_params(locals()))\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:69: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7fd891dae3c0>\ncb = <function Channel.send.<locals>.<lambda> at 0x7fd86b766fb0>\nis_internal = False, title = None\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(\n            task, \"__pw_stack__\", None\n        ) or inspect.stack(0)\n    \n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nE           Call log:\nE             - waiting for get_by_role(\"button\", name=\"Add site\")\n\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:559: TimeoutError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":2,"retriesStatusChange":true,"beforeStages":[{"name":"base_url","time":{"start":1769769795624,"stop":1769769795624,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1769769795624,"stop":1769769795624,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1769769795625,"stop":1769769795626,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1769769795626,"stop":1769769795630,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"onboarding","time":{"start":1769769795630,"stop":1769769819526,"duration":23896},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"programmes_enabled","time":{"start":1769769795630,"stop":1769769795630,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"year_groups","time":{"start":1769769795630,"stop":1769769795630,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1769769795630,"stop":1769769795630,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"team","time":{"start":1769769819526,"stop":1769769819526,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1769769819526,"stop":1769769819526,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1769769819526,"stop":1769769819986,"duration":460},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests","time":{"start":1769769819526,"stop":1769769819526,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"device","time":{"start":1769769819987,"stop":1769769819987,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1769769819987,"stop":1769769819988,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connect_options","time":{"start":1769769819988,"stop":1769769819988,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1769769819988,"stop":1769769820177,"duration":189},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1769769819988,"stop":1769769819988,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder","time":{"start":1769769820179,"stop":1769769820188,"duration":9},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1769769820188,"stop":1769769820189,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1769769820189,"stop":1769769820189,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_token","time":{"start":1769769820189,"stop":1769769820189,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_credentials","time":{"start":1769769820189,"stop":1769769820189,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"nurse","time":{"start":1769769830130,"stop":1769769830130,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"organisation","time":{"start":1769769851175,"stop":1769769851175,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"schools","time":{"start":1769769851175,"stop":1769769851175,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clinics","time":{"start":1769769851175,"stop":1769769851175,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"reset_before_each_module","time":{"start":1769770160622,"stop":1769770160982,"duration":360},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context","time":{"start":1769770225013,"stop":1769770225013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"output_path","time":{"start":1769770225013,"stop":1769770225013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1769770225013,"stop":1769770225017,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder","time":{"start":1769770225013,"stop":1769770225013,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1769770225017,"stop":1769770225039,"duration":22},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags","time":{"start":1769770225039,"stop":1769770225039,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_as_nurse","time":{"start":1769770225039,"stop":1769770227357,"duration":2318},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1769770225039,"stop":1769770226438,"duration":1399},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1769770225039,"stop":1769770226438,"duration":1399},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.log_in_page.LogInPage object at 0x7fd86b603490>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse') and choose team Team(name='Marshall LLC est. 1983', workgroup='A207G', careplus_venue_code='A207GA', careplus_staff_code='A207GB', careplus_staff_type='A207GC', email='psmith@example.org', phone='(07700) 900207')","time":{"start":1769770226439,"stop":1769770227357,"duration":918},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1769770226439,"stop":1769770227357,"duration":918},"status":"passed","steps":[{"name":"Log in as User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse')","time":{"start":1769770226439,"stop":1769770227319,"duration":880},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1769770226439,"stop":1769770227319,"duration":880},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.log_in_page.LogInPage object at 0x7fd86b52f330>, User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse'))"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.log_in_page.LogInPage object at 0x7fd86b52f330>, User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse'), Team(name='Marshall LLC est. 1983', workgroup='A207G', careplus_venue_code='A207GA', careplus_staff_code='A207GB', careplus_staff_type='A207GC', email='psmith@example.org', phone='(07700) 900207'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"children","time":{"start":1769770227357,"stop":1769770227362,"duration":5},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"file_generator","time":{"start":1769770227362,"stop":1769770227362,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\nTest: Importing child records for a school that has been split into sites.\nSteps:\n1. From the team page, create a new school site (Site B) for an existing school.\n2. Attempt to import child records using the original school URN.\n3. Update the input file to use a site-specific URN (with an A/B identifier).\n4. Re-run the import and complete the wizard.\n5. Navigate to the original school and the new site Children pages.\nVerification:\n- An error message is shown when using the original URN, instructing the user\n  to use URNs with site identifiers (e.g. {URN}A or {URN}B).\n- The import succeeds when the child record uses a valid site identifier.\n- The imported child appears under the original school site (A).\n- The imported child does not appear under the new school site (B).\n","status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for get_by_role(\"button\", name=\"Add site\")","statusTrace":"page = <Page url='http://3.8.164.95:4000/draft-school-site/details'>\nlog_in_as_nurse = None\nfile_generator = <mavis.test.data.file_generator.FileGenerator object at 0x7fd87ad98830>\nschools = {'HPV': [School(name='Thames Christian School', urn='132237', site=None, address_line_1='12 Grant Road', address_line_...', site=None, address_line_1='Birchfield Road', address_line_2='', address_town='Widnes', address_postcode='WA8 7TD')]}\nchildren = {'HPV': [Child(first_name='Laura', last_name='ROBERTS', nhs_number='9403972335', address=('Studio 1', 'Lesley Mountain....com'), Parent(full_name='Janice Pugh', relationship=<Relationship.MUM: 'Mum'>, email_address='jsharp@example.net')))]}\n\n    def test_site_child_record_import(\n        page, log_in_as_nurse, file_generator, schools, children\n    ):\n        \"\"\"\n        Test: Importing child records for a school that has been split into sites.\n        Steps:\n        1. From the team page, create a new school site (Site B) for an existing school.\n        2. Attempt to import child records using the original school URN.\n        3. Update the input file to use a site-specific URN (with an A/B identifier).\n        4. Re-run the import and complete the wizard.\n        5. Navigate to the original school and the new site Children pages.\n        Verification:\n        - An error message is shown when using the original URN, instructing the user\n          to use URNs with site identifiers (e.g. {URN}A or {URN}B).\n        - The import succeeds when the child record uses a valid site identifier.\n        - The imported child appears under the original school site (A).\n        - The imported child does not appear under the new school site (B).\n        \"\"\"\n        school = schools[Programme.FLU][0]\n        child = children[Programme.FLU][0]\n    \n        new_site_name = f\"{school} (Site B)\"\n    \n        DashboardPage(page).click_your_team()\n        TeamContactDetailsPage(page).links.click_schools()\n        TeamSchoolsPage(page).click_add_new_school_site()\n        TeamSchoolsPage(page).select_school(school)\n        TeamSchoolsPage(page).fill_site_name(new_site_name)\n        TeamSchoolsPage(page).click_continue()\n>       TeamSchoolsPage(page).confirm_site()\n\ntests/test_team.py:119: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/annotations.py:50: in wrapper\n    return_value = func(*args, **kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^\nmavis/test/pages/team/team_schools_page.py:126: in confirm_site\n    self.confirm_site_button.click()\n.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py:15637: in click\n    self._sync(\n.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py:162: in click\n    return await self._frame._click(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py:566: in _click\n    await self._channel.send(\"click\", self._timeout, locals_to_params(locals()))\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:69: in send\n    return await self._connection.wrap_api_call(\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <playwright._impl._connection.Connection object at 0x7fd891dae3c0>\ncb = <function Channel.send.<locals>.<lambda> at 0x7fd86b766fb0>\nis_internal = False, title = None\n\n    async def wrap_api_call(\n        self, cb: Callable[[], Any], is_internal: bool = False, title: str = None\n    ) -> Any:\n        if self._api_zone.get():\n            return await cb()\n        task = asyncio.current_task(self._loop)\n        st: List[inspect.FrameInfo] = getattr(\n            task, \"__pw_stack__\", None\n        ) or inspect.stack(0)\n    \n        parsed_st = _extract_stack_trace_information_from_stack(st, is_internal, title)\n        self._api_zone.set(parsed_st)\n        try:\n            return await cb()\n        except Exception as error:\n>           raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\nE           playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nE           Call log:\nE             - waiting for get_by_role(\"button\", name=\"Add site\")\n\n.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py:559: TimeoutError","steps":[{"name":"Click on Your Team","time":{"start":1769770227363,"stop":1769770227570,"duration":207},"status":"passed","steps":[{"name":"Click on Your Team","time":{"start":1769770227363,"stop":1769770227570,"duration":207},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.dashboard_page.DashboardPage object at 0x7fd86b5e9a70>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Schools","time":{"start":1769770227570,"stop":1769770227915,"duration":345},"status":"passed","steps":[{"name":"Click on Schools","time":{"start":1769770227570,"stop":1769770227915,"duration":345},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.team.team_links_component.TeamLinksComponent object at 0x7fd86b74f8d0>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Add a new school site","time":{"start":1769770227915,"stop":1769770228223,"duration":308},"status":"passed","steps":[{"name":"Click on Add a new school site","time":{"start":1769770227915,"stop":1769770228223,"duration":308},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.team.team_schools_page.TeamSchoolsPage object at 0x7fd87a3bba10>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select a school","time":{"start":1769770228223,"stop":1769770228979,"duration":756},"status":"passed","steps":[{"name":"Select a school","time":{"start":1769770228223,"stop":1769770228979,"duration":756},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.team.team_schools_page.TeamSchoolsPage object at 0x7fd87a3bb890>, School(name='Freebrough Academy', urn='147541', site=None, address_line_1='Linden Road', address_line_2='', address_town='Saltburn-By-the-Sea', address_postcode='TS12 2SJ'))"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Fill site name 'Freebrough Academy (Site B)'","time":{"start":1769770228979,"stop":1769770229010,"duration":31},"status":"passed","steps":[{"name":"Fill site name {1}","time":{"start":1769770228979,"stop":1769770229010,"duration":31},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.team.team_schools_page.TeamSchoolsPage object at 0x7fd87af09c10>, 'Freebrough Academy (Site B)')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Confirm site","time":{"start":1769770229254,"stop":1769770259492,"duration":30238},"status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for get_by_role(\"button\", name=\"Add site\")\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/allure_commons/_allure.py\", line 202, in impl\n    return func(*a, **kw)\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/annotations.py\", line 50, in wrapper\n    return_value = func(*args, **kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/pages/team/team_schools_page.py\", line 126, in confirm_site\n    self.confirm_site_button.click()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 15637, in click\n    self._sync(\n    ~~~~~~~~~~^\n        self._impl_obj.click(\n        ^^^^^^^^^^^^^^^^^^^^^\n    ...<10 lines>...\n        )\n        ^\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py\", line 162, in click\n    return await self._frame._click(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py\", line 566, in _click\n    await self._channel.send(\"click\", self._timeout, locals_to_params(locals()))\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 69, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 559, in wrap_api_call\n    raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\n","steps":[{"name":"Confirm site","time":{"start":1769770229254,"stop":1769770259491,"duration":30237},"status":"broken","statusMessage":"playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for get_by_role(\"button\", name=\"Add site\")\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/annotations.py\", line 50, in wrapper\n    return_value = func(*args, **kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/pages/team/team_schools_page.py\", line 126, in confirm_site\n    self.confirm_site_button.click()\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 15637, in click\n    self._sync(\n    ~~~~~~~~~~^\n        self._impl_obj.click(\n        ^^^^^^^^^^^^^^^^^^^^^\n    ...<10 lines>...\n        )\n        ^\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_locator.py\", line 162, in click\n    return await self._frame._click(self._selector, strict=True, **params)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_frame.py\", line 566, in _click\n    await self._channel.send(\"click\", self._timeout, locals_to_params(locals()))\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 69, in send\n    return await self._connection.wrap_api_call(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<3 lines>...\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_connection.py\", line 559, in wrap_api_call\n    raise rewrite_error(error, f\"{parsed_st['apiName']}: {error}\") from None\n","steps":[],"attachments":[{"uid":"5fc4943791909e71","name":"Screenshot on failure","source":"5fc4943791909e71.png","type":"image/png","size":26063}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.team.team_schools_page.TeamSchoolsPage object at 0x7fd87af0b7d0>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":12,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"set_feature_flags::0","time":{"start":1769770259664,"stop":1769770259664,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context::0","time":{"start":1769770259665,"stop":1769770259672,"duration":7},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder::0","time":{"start":1769770259673,"stop":1769770259673,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder::0","time":{"start":1769770375747,"stop":1769770375747,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1769770375748,"stop":1769770375771,"duration":23},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1769770375772,"stop":1769770375785,"duration":13},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests::0","time":{"start":1769770375786,"stop":1769770376191,"duration":405},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"team"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_team"},{"name":"host","value":"runnervmkj6or"},{"name":"thread","value":"3143-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_team"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"4f4e904d744c2af6","status":"broken","statusDetails":"playwright._impl._errors.TimeoutError: Locator.click: Timeout 30000ms exceeded.\nCall log:\n  - waiting for get_by_role(\"button\", name=\"Add site\")","time":{"start":1769770192556,"stop":1769770224862,"duration":32306}},{"uid":"9b0ebbd4690d2de0","status":"failed","statusDetails":"AssertionError: Locator expected to contain text '1 imported record'\nActual value: \n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:49am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileChildFileMapping.FIXED_CHILD20260130104937.csvTypeChild recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for child records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesCHILD_FIRST_NAMERequired, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).CHILD_LAST_NAMERequired, must use alphabetical characters (you can include accents like Jiménez, hyphens like Burne-Jones or apostrophes like O'Hare but no other special characters).CHILD_PREFERRED_FIRST_NAMEOptional, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).CHILD_PREFERRED_LAST_NAMEOptional, must use alphabetical characters (you can include accents like Jiménez, hyphens like Burne-Jones or apostrophes like O'Hare but no other special characters).CHILD_DATE_OF_BIRTHRequired, must use DD/MM/YYYY or YYYY-MM-DD format.CHILD_YEAR_GROUPOptional, numeric, the child’s year group, for example 8. If present, and when the child’s date of birth would place them in a different year, this value can be used to override the cohort the child will be placed in.CHILD_REGISTRATIONOptional, the child’s registration group, for example 8T5.CHILD_NHS_NUMBEROptional, must be 10 digits and numeric.CHILD_GENDEROptional, must be one of: female, male, not known or not specified.CHILD_ADDRESS_LINE_1OptionalCHILD_ADDRESS_LINE_2OptionalCHILD_TOWNOptionalCHILD_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.CHILD_SCHOOL_URNRequired, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.PARENT_1_NAMEOptional, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).PARENT_1_RELATIONSHIPOptional, must be one of: Mum, Dad or Guardian.PARENT_1_EMAILOptional, must be formatted as a valid email address.PARENT_1_PHONEOptional, must be formatted as a valid phone number.PARENT_2_NAMEOptional, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).PARENT_2_RELATIONSHIPOptional, must be one of: Mum, Dad or Guardian.PARENT_2_EMAILOptional, must be formatted as a valid email address.PARENT_2_PHONEOptional, must be formatted as a valid phone number.\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  CHILD_SCHOOL_URN: The URN 147541 has been split into sites. Use 147541A or 147541B instead.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n       \nCall log:\n  - Expect \"to_contain_text\" with timeout 5000ms\n  - waiting for get_by_role(\"main\")\n    9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\n      - unexpected value \"\n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:49am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileChildFileMapping.FIXED_CHILD20260130104937.csvTypeChild recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for child records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesCHILD_FIRST_NAMERequired, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).CHILD_LAST_NAMERequired, must use alphabetical characters (you can include accents like Jiménez, hyphens like Burne-Jones or apostrophes like O'Hare but no other special characters).CHILD_PREFERRED_FIRST_NAMEOptional, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).CHILD_PREFERRED_LAST_NAMEOptional, must use alphabetical characters (you can include accents like Jiménez, hyphens like Burne-Jones or apostrophes like O'Hare but no other special characters).CHILD_DATE_OF_BIRTHRequired, must use DD/MM/YYYY or YYYY-MM-DD format.CHILD_YEAR_GROUPOptional, numeric, the child’s year group, for example 8. If present, and when the child’s date of birth would place them in a different year, this value can be used to override the cohort the child will be placed in.CHILD_REGISTRATIONOptional, the child’s registration group, for example 8T5.CHILD_NHS_NUMBEROptional, must be 10 digits and numeric.CHILD_GENDEROptional, must be one of: female, male, not known or not specified.CHILD_ADDRESS_LINE_1OptionalCHILD_ADDRESS_LINE_2OptionalCHILD_TOWNOptionalCHILD_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.CHILD_SCHOOL_URNRequired, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.PARENT_1_NAMEOptional, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).PARENT_1_RELATIONSHIPOptional, must be one of: Mum, Dad or Guardian.PARENT_1_EMAILOptional, must be formatted as a valid email address.PARENT_1_PHONEOptional, must be formatted as a valid phone number.PARENT_2_NAMEOptional, must use alphabetical characters (you can include accents like Chloë, hyphens like Anne-Marie or apostrophes like D'Arcy but no other special characters).PARENT_2_RELATIONSHIPOptional, must be one of: Mum, Dad or Guardian.PARENT_2_EMAILOptional, must be formatted as a valid email address.PARENT_2_PHONEOptional, must be formatted as a valid phone number.\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  CHILD_SCHOOL_URN: The URN 147541 has been split into sites. Use 147541A or 147541B instead.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n      \"","time":{"start":1769770175190,"stop":1769770190072,"duration":14882}}],"categories":[{"name":"Test defects","matchedStatuses":[]}],"tags":["team"]},"source":"ca273e708d9216ae.json","parameterValues":[]}