{"uid":"96d6bb8969bfb9a1","name":"test_historical_vaccination_file_upload_creates_child","fullName":"tests.test_import_historical_vaccinations#test_historical_vaccination_file_upload_creates_child","historyId":"37963dbfe43ed30fa06050893ab6fc8a","time":{"start":1769770355758,"stop":1769770361762,"duration":6004},"description":"\nTest: Upload a vaccination file and verify the child record and vaccination record\n   exist.\nSteps:\n1. Upload a vaccination file for a child not in mavis.\n2. Navigate to children page and search for the child.\n3. Open vaccination details for the child.\nVerification:\n- Vaccination record and child record exist.\n","descriptionHtml":"<p>Test: Upload a vaccination file and verify the child record and vaccination record<br />\nexist.<br />\nSteps:</p>\n<ol>\n<li>Upload a vaccination file for a child not in mavis.</li>\n<li>Navigate to children page and search for the child.</li>\n<li>Open vaccination details for the child.<br />\nVerification:</li>\n</ol>\n<ul>\n<li>Vaccination record and child record exist.</li>\n</ul>\n","status":"failed","statusMessage":"AssertionError: Locator expected to contain text '1 imported record'\nActual value: \n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n       \nCall log:\n  - Expect \"to_contain_text\" with timeout 5000ms\n  - waiting for get_by_role(\"main\")\n    9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\n      - unexpected value \"\n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n      \"","statusTrace":"setup_hist_vaccs = None\nschools = {'HPV': [School(name='Thames Christian School', urn='132237', site=None, address_line_1='12 Grant Road', address_line_...', site=None, address_line_1='Birchfield Road', address_line_2='', address_town='Widnes', address_postcode='WA8 7TD')]}\npage = <Page url='http://3.8.164.95:4000/immunisation-imports/57'>\nfile_generator = <mavis.test.data.file_generator.FileGenerator object at 0x7fd86a00b890>\nchildren = {'HPV': [Child(first_name='Elliott', last_name='HILL', nhs_number='9258832582', address=('Flat 01B', 'Ashley Trafficwa... Parent(full_name='June Bentley', relationship=<Relationship.MUM: 'Mum'>, email_address='nataliejones@example.org')))]}\n\n    def test_historical_vaccination_file_upload_creates_child(\n        setup_hist_vaccs,\n        schools,\n        page,\n        file_generator,\n        children,\n    ):\n        \"\"\"\n        Test: Upload a vaccination file and verify the child record and vaccination record\n           exist.\n        Steps:\n        1. Upload a vaccination file for a child not in mavis.\n        2. Navigate to children page and search for the child.\n        3. Open vaccination details for the child.\n        Verification:\n        - Vaccination record and child record exist.\n        \"\"\"\n        child = children[Programme.HPV][0]\n        school = schools[Programme.HPV][0]\n    \n>       ImportRecordsWizardPage(page, file_generator).upload_and_verify_output(\n            VaccsFileMapping.HIST_HPV\n        )\n\ntests/test_import_historical_vaccinations.py:109: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/imports/import_records_wizard_page.py:179: in upload_and_verify_output\n    self.upload_and_verify_output_for_input_output_files(\nmavis/test/pages/imports/import_records_wizard_page.py:191: in upload_and_verify_output_for_input_output_files\n    self.verify_upload_output(file_path=output_file_path)\nmavis/test/annotations.py:50: in wrapper\n    return_value = func(*args, **kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd872145ef0>\nfile_path = PosixPath('vaccs/o_hist_hpv.txt')\n\n    @step(\"Verify upload output for {file_path}\")\n    def verify_upload_output(self, file_path: Path) -> None:\n        _expected_errors = self.file_generator.get_expected_errors(file_path)\n        if _expected_errors is not None:\n            for _msg in _expected_errors:\n                if _msg.startswith(\"!\"):\n                    expect(self.page.get_by_role(\"main\")).not_to_contain_text(_msg[1:])\n                else:\n>                   expect(self.page.get_by_role(\"main\")).to_contain_text(_msg)\nE                   AssertionError: Locator expected to contain text '1 imported record'\nE                   Actual value: \nE                           \nE                   \nE                             \nE                       \nE                         \nE                   \nE                         \nE                     Upload (30 January 2026 at 10:52am)\nE                   \nE                       \nE                   \nE                         \nE                             Details\nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                     Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\nE                   \nE                         \nE                       \nE                   \nE                   \nE                             \nE                   \nE                         \nE                                     Records could not be imported\nE                   \nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                         \nE                       \nE                         The records cannot be uploaded due to errors in the CSV file.\nE                   \nE                       \nE                   \nE                       How to format your Mavis CSV file for vaccination records\nE                     Make sure the CSV you upload uses the following columns:\nE                   \nE                     Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\nE                   \nE                   \nE                   \nE                           \nE                               \nE                                   Row 2\nE                               \nE                   \nE                               \nE                                     SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\nE                               \nE                           \nE                   \nE                         \nE                       \nE                   \nE                   \nE                   \nE                   \nE                       \nE                     \nE                   \nE                          \nE                   Call log:\nE                     - Expect \"to_contain_text\" with timeout 5000ms\nE                     - waiting for get_by_role(\"main\")\nE                       9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\nE                         - unexpected value \"\nE                           \nE                   \nE                             \nE                       \nE                         \nE                   \nE                         \nE                     Upload (30 January 2026 at 10:52am)\nE                   \nE                       \nE                   \nE                         \nE                             Details\nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                     Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\nE                   \nE                         \nE                       \nE                   \nE                   \nE                             \nE                   \nE                         \nE                                     Records could not be imported\nE                   \nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                         \nE                       \nE                         The records cannot be uploaded due to errors in the CSV file.\nE                   \nE                       \nE                   \nE                       How to format your Mavis CSV file for vaccination records\nE                     Make sure the CSV you upload uses the following columns:\nE                   \nE                     Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\nE                   \nE                   \nE                   \nE                           \nE                               \nE                                   Row 2\nE                               \nE                   \nE                               \nE                                     SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\nE                               \nE                           \nE                   \nE                         \nE                       \nE                   \nE                   \nE                   \nE                   \nE                       \nE                     \nE                   \nE                         \"\n\nmavis/test/pages/imports/import_records_wizard_page.py:240: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":2,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1769769795624,"stop":1769769795624,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1769769795624,"stop":1769769795624,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1769769795625,"stop":1769769795626,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1769769795626,"stop":1769769795630,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"onboarding","time":{"start":1769769795630,"stop":1769769819526,"duration":23896},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"programmes_enabled","time":{"start":1769769795630,"stop":1769769795630,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"year_groups","time":{"start":1769769795630,"stop":1769769795630,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1769769795630,"stop":1769769795630,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"team","time":{"start":1769769819526,"stop":1769769819526,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1769769819526,"stop":1769769819526,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1769769819526,"stop":1769769819986,"duration":460},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests","time":{"start":1769769819526,"stop":1769769819526,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"device","time":{"start":1769769819987,"stop":1769769819987,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1769769819987,"stop":1769769819988,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connect_options","time":{"start":1769769819988,"stop":1769769819988,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1769769819988,"stop":1769769820177,"duration":189},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1769769819988,"stop":1769769819988,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder","time":{"start":1769769820179,"stop":1769769820188,"duration":9},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1769769820188,"stop":1769769820189,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1769769820189,"stop":1769769820189,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_token","time":{"start":1769769820189,"stop":1769769820189,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_credentials","time":{"start":1769769820189,"stop":1769769820189,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"nurse","time":{"start":1769769830130,"stop":1769769830130,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"organisation","time":{"start":1769769851175,"stop":1769769851175,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"schools","time":{"start":1769769851175,"stop":1769769851175,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clinics","time":{"start":1769769851175,"stop":1769769851175,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"reset_before_each_module","time":{"start":1769770259676,"stop":1769770260039,"duration":363},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"output_path","time":{"start":1769770351708,"stop":1769770351708,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder","time":{"start":1769770351708,"stop":1769770351708,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context","time":{"start":1769770351708,"stop":1769770351709,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1769770351709,"stop":1769770351715,"duration":6},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1769770351715,"stop":1769770351740,"duration":25},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags","time":{"start":1769770351740,"stop":1769770351740,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_as_nurse","time":{"start":1769770351741,"stop":1769770354014,"duration":2273},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1769770351741,"stop":1769770353068,"duration":1327},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1769770351741,"stop":1769770353068,"duration":1327},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.log_in_page.LogInPage object at 0x7fd878b11910>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse') and choose team Team(name='Marshall LLC est. 1983', workgroup='A207G', careplus_venue_code='A207GA', careplus_staff_code='A207GB', careplus_staff_type='A207GC', email='psmith@example.org', phone='(07700) 900207')","time":{"start":1769770353068,"stop":1769770354014,"duration":946},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1769770353068,"stop":1769770354014,"duration":946},"status":"passed","steps":[{"name":"Log in as User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse')","time":{"start":1769770353068,"stop":1769770353968,"duration":900},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1769770353068,"stop":1769770353968,"duration":900},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.log_in_page.LogInPage object at 0x7fd87a304d60>, User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse'))"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.log_in_page.LogInPage object at 0x7fd87a304d60>, User(username='lewiskate@example.net', password='lewiskate@example.net', role='nurse'), Team(name='Marshall LLC est. 1983', workgroup='A207G', careplus_venue_code='A207GA', careplus_staff_code='A207GB', careplus_staff_type='A207GC', email='psmith@example.org', phone='(07700) 900207'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"children","time":{"start":1769770354014,"stop":1769770354018,"duration":4},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"file_generator","time":{"start":1769770354018,"stop":1769770354019,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_hist_vaccs","time":{"start":1769770354019,"stop":1769770355757,"duration":1738},"status":"passed","steps":[{"name":"Click on Imports","time":{"start":1769770354020,"stop":1769770354391,"duration":371},"status":"passed","steps":[{"name":"Click on Imports","time":{"start":1769770354020,"stop":1769770354391,"duration":371},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.dashboard_page.DashboardPage object at 0x7fd872c35390>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Upload records","time":{"start":1769770354391,"stop":1769770355065,"duration":674},"status":"passed","steps":[{"name":"Click on Upload records","time":{"start":1769770354391,"stop":1769770355065,"duration":674},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.imports_page.ImportsPage object at 0x7fd86a213f50>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select Vaccination Records","time":{"start":1769770355065,"stop":1769770355132,"duration":67},"status":"passed","steps":[{"name":"Select Vaccination Records","time":{"start":1769770355065,"stop":1769770355132,"duration":67},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd8728da190>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1769770355132,"stop":1769770355757,"duration":625},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1769770355132,"stop":1769770355757,"duration":625},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd8728da190>,)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":8,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"testStage":{"description":"\nTest: Upload a vaccination file and verify the child record and vaccination record\n   exist.\nSteps:\n1. Upload a vaccination file for a child not in mavis.\n2. Navigate to children page and search for the child.\n3. Open vaccination details for the child.\nVerification:\n- Vaccination record and child record exist.\n","status":"failed","statusMessage":"AssertionError: Locator expected to contain text '1 imported record'\nActual value: \n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n       \nCall log:\n  - Expect \"to_contain_text\" with timeout 5000ms\n  - waiting for get_by_role(\"main\")\n    9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\n      - unexpected value \"\n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n      \"","statusTrace":"setup_hist_vaccs = None\nschools = {'HPV': [School(name='Thames Christian School', urn='132237', site=None, address_line_1='12 Grant Road', address_line_...', site=None, address_line_1='Birchfield Road', address_line_2='', address_town='Widnes', address_postcode='WA8 7TD')]}\npage = <Page url='http://3.8.164.95:4000/immunisation-imports/57'>\nfile_generator = <mavis.test.data.file_generator.FileGenerator object at 0x7fd86a00b890>\nchildren = {'HPV': [Child(first_name='Elliott', last_name='HILL', nhs_number='9258832582', address=('Flat 01B', 'Ashley Trafficwa... Parent(full_name='June Bentley', relationship=<Relationship.MUM: 'Mum'>, email_address='nataliejones@example.org')))]}\n\n    def test_historical_vaccination_file_upload_creates_child(\n        setup_hist_vaccs,\n        schools,\n        page,\n        file_generator,\n        children,\n    ):\n        \"\"\"\n        Test: Upload a vaccination file and verify the child record and vaccination record\n           exist.\n        Steps:\n        1. Upload a vaccination file for a child not in mavis.\n        2. Navigate to children page and search for the child.\n        3. Open vaccination details for the child.\n        Verification:\n        - Vaccination record and child record exist.\n        \"\"\"\n        child = children[Programme.HPV][0]\n        school = schools[Programme.HPV][0]\n    \n>       ImportRecordsWizardPage(page, file_generator).upload_and_verify_output(\n            VaccsFileMapping.HIST_HPV\n        )\n\ntests/test_import_historical_vaccinations.py:109: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/imports/import_records_wizard_page.py:179: in upload_and_verify_output\n    self.upload_and_verify_output_for_input_output_files(\nmavis/test/pages/imports/import_records_wizard_page.py:191: in upload_and_verify_output_for_input_output_files\n    self.verify_upload_output(file_path=output_file_path)\nmavis/test/annotations.py:50: in wrapper\n    return_value = func(*args, **kwargs)\n                   ^^^^^^^^^^^^^^^^^^^^^\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\nself = <mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd872145ef0>\nfile_path = PosixPath('vaccs/o_hist_hpv.txt')\n\n    @step(\"Verify upload output for {file_path}\")\n    def verify_upload_output(self, file_path: Path) -> None:\n        _expected_errors = self.file_generator.get_expected_errors(file_path)\n        if _expected_errors is not None:\n            for _msg in _expected_errors:\n                if _msg.startswith(\"!\"):\n                    expect(self.page.get_by_role(\"main\")).not_to_contain_text(_msg[1:])\n                else:\n>                   expect(self.page.get_by_role(\"main\")).to_contain_text(_msg)\nE                   AssertionError: Locator expected to contain text '1 imported record'\nE                   Actual value: \nE                           \nE                   \nE                             \nE                       \nE                         \nE                   \nE                         \nE                     Upload (30 January 2026 at 10:52am)\nE                   \nE                       \nE                   \nE                         \nE                             Details\nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                     Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\nE                   \nE                         \nE                       \nE                   \nE                   \nE                             \nE                   \nE                         \nE                                     Records could not be imported\nE                   \nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                         \nE                       \nE                         The records cannot be uploaded due to errors in the CSV file.\nE                   \nE                       \nE                   \nE                       How to format your Mavis CSV file for vaccination records\nE                     Make sure the CSV you upload uses the following columns:\nE                   \nE                     Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\nE                   \nE                   \nE                   \nE                           \nE                               \nE                                   Row 2\nE                               \nE                   \nE                               \nE                                     SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\nE                               \nE                           \nE                   \nE                         \nE                       \nE                   \nE                   \nE                   \nE                   \nE                       \nE                     \nE                   \nE                          \nE                   Call log:\nE                     - Expect \"to_contain_text\" with timeout 5000ms\nE                     - waiting for get_by_role(\"main\")\nE                       9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\nE                         - unexpected value \"\nE                           \nE                   \nE                             \nE                       \nE                         \nE                   \nE                         \nE                     Upload (30 January 2026 at 10:52am)\nE                   \nE                       \nE                   \nE                         \nE                             Details\nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                     Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\nE                   \nE                         \nE                       \nE                   \nE                   \nE                             \nE                   \nE                         \nE                                     Records could not be imported\nE                   \nE                   \nE                   \nE                   \nE                   \nE                           \nE                   \nE                         \nE                       \nE                         The records cannot be uploaded due to errors in the CSV file.\nE                   \nE                       \nE                   \nE                       How to format your Mavis CSV file for vaccination records\nE                     Make sure the CSV you upload uses the following columns:\nE                   \nE                     Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\nE                   \nE                   \nE                   \nE                           \nE                               \nE                                   Row 2\nE                               \nE                   \nE                               \nE                                     SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\nE                               \nE                           \nE                   \nE                         \nE                       \nE                   \nE                   \nE                   \nE                   \nE                       \nE                     \nE                   \nE                         \"\n\nmavis/test/pages/imports/import_records_wizard_page.py:240: AssertionError","steps":[{"name":"Set input file to PosixPath('working/working_gw3/VaccsFileMapping.HIST_HPV20260130105235.csv')","time":{"start":1769770355769,"stop":1769770355790,"duration":21},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1769770355769,"stop":1769770355790,"duration":21},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd872145ef0>, PosixPath('working/working_gw3/VaccsFileMapping.HIST_HPV20260130105235.csv'))"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1769770355790,"stop":1769770356219,"duration":429},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1769770355790,"stop":1769770356219,"duration":429},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd872145ef0>,)"},{"name":"_coverage","value":"None"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click import link for PosixPath('working/working_gw3/VaccsFileMapping.HIST_HPV20260130105235.csv')","time":{"start":1769770356252,"stop":1769770356500,"duration":248},"status":"passed","steps":[{"name":"Click import link for {1}","time":{"start":1769770356252,"stop":1769770356500,"duration":248},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd872145ef0>, PosixPath('working/working_gw3/VaccsFileMapping.HIST_HPV20260130105235.csv'))"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Reload until completed status appears","time":{"start":1769770356500,"stop":1769770356524,"duration":24},"status":"passed","steps":[{"name":"Reload until completed status appears","time":{"start":1769770356500,"stop":1769770356524,"duration":24},"status":"passed","steps":[{"name":"Reload page until <Locator frame=<Frame name= url='http://3.8.164.95:4000/immunisation-imports/57'> selector='internal:role=strong >> internal:text=\"Review and approve\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Completed\\\\\"i\" >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\" >> internal:or=\"internal:text=\\\\\"There is a problem\\\\\"i\" >> nth=0'> is visible","time":{"start":1769770356500,"stop":1769770356524,"duration":24},"status":"passed","steps":[{"name":"Reload page until {1} is visible","time":{"start":1769770356500,"stop":1769770356524,"duration":24},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<Page url='http://3.8.164.95:4000/immunisation-imports/57'>, <Locator frame=<Frame name= url='http://3.8.164.95:4000/immunisation-imports/57'> selector='internal:role=strong >> internal:text=\"Review and approve\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Completed\\\\\"i\" >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\" >> internal:or=\"internal:text=\\\\\"There is a problem\\\\\"i\" >> nth=0'>)"},{"name":"seconds","value":"60"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd872145ef0>,)"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Verify upload output for PosixPath('vaccs/o_hist_hpv.txt')","time":{"start":1769770356540,"stop":1769770361760,"duration":5220},"status":"failed","statusMessage":"AssertionError: Locator expected to contain text '1 imported record'\nActual value: \n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n       \nCall log:\n  - Expect \"to_contain_text\" with timeout 5000ms\n  - waiting for get_by_role(\"main\")\n    9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\n      - unexpected value \"\n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n      \"\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/allure_commons/_allure.py\", line 202, in impl\n    return func(*a, **kw)\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/annotations.py\", line 50, in wrapper\n    return_value = func(*args, **kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/pages/imports/import_records_wizard_page.py\", line 240, in verify_upload_output\n    expect(self.page.get_by_role(\"main\")).to_contain_text(_msg)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 19319, in to_contain_text\n    self._sync(\n    ~~~~~~~~~~^\n        self._impl_obj.to_contain_text(\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<4 lines>...\n        )\n        ^\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 229, in to_contain_text\n    await self._expect_impl(\n    ...<9 lines>...\n    )\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 85, in _expect_impl\n    raise AssertionError(\n        f\"{out_message}\\nActual value: {actual}{error_message} {format_call_log(result.get('log'))}\"\n    )\n","steps":[{"name":"Verify upload output for {file_path}","time":{"start":1769770356540,"stop":1769770361759,"duration":5219},"status":"failed","statusMessage":"AssertionError: Locator expected to contain text '1 imported record'\nActual value: \n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n       \nCall log:\n  - Expect \"to_contain_text\" with timeout 5000ms\n  - waiting for get_by_role(\"main\")\n    9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\n      - unexpected value \"\n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105235.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n      \"\n\n","statusTrace":"  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/annotations.py\", line 50, in wrapper\n    return_value = func(*args, **kwargs)\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/mavis/test/pages/imports/import_records_wizard_page.py\", line 240, in verify_upload_output\n    expect(self.page.get_by_role(\"main\")).to_contain_text(_msg)\n    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/sync_api/_generated.py\", line 19319, in to_contain_text\n    self._sync(\n    ~~~~~~~~~~^\n        self._impl_obj.to_contain_text(\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    ...<4 lines>...\n        )\n        ^\n    )\n    ^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_sync_base.py\", line 115, in _sync\n    return task.result()\n           ~~~~~~~~~~~^^\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 229, in to_contain_text\n    await self._expect_impl(\n    ...<9 lines>...\n    )\n  File \"/home/runner/work/manage-vaccinations-in-schools/manage-vaccinations-in-schools/.venv/lib/python3.14/site-packages/playwright/_impl/_assertions.py\", line 85, in _expect_impl\n    raise AssertionError(\n        f\"{out_message}\\nActual value: {actual}{error_message} {format_call_log(result.get('log'))}\"\n    )\n","steps":[],"attachments":[{"uid":"df93436a3f1aefe6","name":"Screenshot on failure","source":"df93436a3f1aefe6.png","type":"image/png","size":29141}],"parameters":[],"shouldDisplayMessage":true,"stepsCount":0,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(<mavis.test.pages.imports.import_records_wizard_page.ImportRecordsWizardPage object at 0x7fd872145ef0>,)"},{"name":"file_path","value":"PosixPath('vaccs/o_hist_hpv.txt')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":1,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":12,"attachmentsCount":1,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"set_feature_flags::0","time":{"start":1769770361779,"stop":1769770361779,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context::0","time":{"start":1769770361780,"stop":1769770361792,"duration":12},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder::0","time":{"start":1769770361793,"stop":1769770361793,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder::0","time":{"start":1769770375747,"stop":1769770375747,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1769770375748,"stop":1769770375771,"duration":23},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1769770375772,"stop":1769770375785,"duration":13},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests::0","time":{"start":1769770375786,"stop":1769770376191,"duration":405},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_import_historical_vaccinations"},{"name":"host","value":"runnervmkj6or"},{"name":"thread","value":"3143-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_import_historical_vaccinations"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"a5afc7c15f366c1c","status":"failed","statusDetails":"AssertionError: Locator expected to contain text '1 imported record'\nActual value: \n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105225.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n       \nCall log:\n  - Expect \"to_contain_text\" with timeout 5000ms\n  - waiting for get_by_role(\"main\")\n    9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\n      - unexpected value \"\n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105225.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n      \"","time":{"start":1769770345558,"stop":1769770351684,"duration":6126}},{"uid":"c76d90cf20c94b69","status":"failed","statusDetails":"AssertionError: Locator expected to contain text '1 imported record'\nActual value: \n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105215.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n       \nCall log:\n  - Expect \"to_contain_text\" with timeout 5000ms\n  - waiting for get_by_role(\"main\")\n    9 × locator resolved to <main role=\"main\" id=\"main-content\" class=\"nhsuk-main-wrapper\">…</main>\n      - unexpected value \"\n        \n\n          \n    \n      \n\n      \n  Upload (30 January 2026 at 10:52am)\n\n    \n\n      \n          Details\n\n\n\n\n        \n\n  Uploaded byNURSE, NurseFileVaccsFileMapping.HIST_HPV20260130105215.csvTypeVaccination recordsStatusInvalid\n\n      \n    \n\n\n          \n\n      \n                  Records could not be imported\n\n\n\n\n\n        \n\n      \n    \n      The records cannot be uploaded due to errors in the CSV file.\n\n    \n\n    How to format your Mavis CSV file for vaccination records\n  Make sure the CSV you upload uses the following columns:\n\n  Column nameNotesORGANISATION_CODEOptional, must be a valid ODS code.SCHOOL_URNOptional, must be 6 digits and numeric. Use 888888 for school unknown and 999999 for homeschooled.SCHOOL_NAMERequired if SCHOOL_URN is 888888.NHS_NUMBEROptional, must be a valid NHS number.PERSON_FORENAMERequiredPERSON_SURNAMERequiredPERSON_DOBRequired, must use either YYYYMMDD or DD/MM/YYYY format.PERSON_GENDER_CODERequired, must be one of: female, male, not known or not specified.PERSON_POSTCODERequired, must be formatted as a valid postcode, for example SW1A 1AA.DATE_OF_VACCINATIONRequired, must use either YYYYMMDD or DD/MM/YYYY format.TIME_OF_VACCINATIONOptional, must use HH:MM:SS format.VACCINATEDRequired, must be Y or N. Can be omitted if VACCINE_GIVEN is provided.VACCINE_GIVENOptional, must be one of: Sequirus Cell-based Trivalent, AstraZeneca Fluenz, Sanofi Vaxigrip, Viatris, Cervarix, Gardasil, Gardasil9, MenQuadfi, Menveo, Nimenrix, Priorix, VaxPro, ProQuad, Priorix-Tetra or Revaxis.BATCH_NUMBERRequired if BATCH_EXPIRY_DATE is provided.BATCH_EXPIRY_DATERequired if BATCH_NUMBER is provided, must use either YYYYMMDD or DD/MM/YYYY format.PROGRAMMERequired, must be Flu, HPV, ACWYX4, MenACWY, MMR, MMRV, 3-in-1 or Td/IPV.ANATOMICAL_SITEOptional, if provided must be appropriate for the vaccine delivery method and be one of: left arm (lower position), left arm (upper position), left buttock, left deltoid, left thigh, left upper arm, nasal, right arm (lower position), right arm (upper position), right buttock, right deltoid, right thigh or right upper arm.REASON_NOT_VACCINATEDRequired if VACCINATED is N, must be already had elsewhere, refused, unwell or vaccination contraindicated.NOTESOptionalDOSE_SEQUENCEOptional, must be a number or 1B, 1P, 1st Scheduled Booster, 2B, 2P, 2nd Scheduled Booster or 3P.CARE_SETTINGOptional, must be 1 (school) or 2 (clinic).CLINIC_NAMERequired if CARE_SETTING is 2, must be the name of a community clinic location.PERFORMING_PROFESSIONAL_EMAILRequired if uploading offline vaccination records.PERFORMING_PROFESSIONAL_FORENAMEOptionalPERFORMING_PROFESSIONAL_SURNAMEOptional\n\n\n\n        \n            \n                Row 2\n            \n\n            \n                  SCHOOL_URN: The school URN is not recognised. If you’ve checked the URN, and you believe it’s valid, contact our support team.\n            \n        \n\n      \n    \n\n\n\n\n    \n  \n\n      \"","time":{"start":1769770335445,"stop":1769770341590,"duration":6145}}],"categories":[{"name":"Product defects","matchedStatuses":[]}],"tags":[]},"source":"96d6bb8969bfb9a1.json","parameterValues":[]}