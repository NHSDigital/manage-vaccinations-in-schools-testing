{"uid":"bc9ea4ad31653ac0","name":"test_class_list_file_upload_whitespace_normalization","fullName":"tests.test_import_class_lists#test_class_list_file_upload_whitespace_normalization","historyId":"e60a78aedf7c715a7eaea63ee42ce698","time":{"start":1761972494431,"stop":1761972610880,"duration":116449},"description":"\nTest: Upload a class list file with extra whitespace and verify normalization.\nSteps:\n1. Upload a file with whitespace issues.\n2. Navigate to children page.\n3. Verify the list is normalized and imported correctly.\nVerification:\n- Imported list matches expected normalized data.\n","descriptionHtml":"<p>Test: Upload a class list file with extra whitespace and verify normalization.<br />\nSteps:</p>\n<ol>\n<li>Upload a file with whitespace issues.</li>\n<li>Navigate to children page.</li>\n<li>Verify the list is normalized and imported correctly.<br />\nVerification:</li>\n</ol>\n<ul>\n<li>Imported list matches expected normalized data.</li>\n</ul>\n","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))","statusTrace":"setup_class_list = None\nschools = {'HPV': [School(name='Acorn School', urn='135773', site=None), School(name='Beverley School', urn='111773', site=None)...ool(name='Oak Lodge School', urn='116637', site=None), School(name='Corby Business Academy', urn='135306', site=None)]}\nimport_records_page = <mavis.test.pages.import_records.ImportRecordsPage object at 0x7f972aeaadd0>\nchildren_page = <mavis.test.pages.children.ChildrenPage object at 0x7f972afeb250>\ndashboard_page = <mavis.test.pages.dashboard.DashboardPage object at 0x7f972b0562b0>\nyear_groups = {'HPV': 10, 'MMR': 1, 'doubles': 10, 'flu': 9}\n\n    @pytest.mark.classlist\n    @pytest.mark.bug\n    def test_class_list_file_upload_whitespace_normalization(\n        setup_class_list,\n        schools,\n        import_records_page,\n        children_page,\n        dashboard_page,\n        year_groups,\n    ):\n        \"\"\"\n        Test: Upload a class list file with extra whitespace and verify normalization.\n        Steps:\n        1. Upload a file with whitespace issues.\n        2. Navigate to children page.\n        3. Verify the list is normalized and imported correctly.\n        Verification:\n        - Imported list matches expected normalized data.\n        \"\"\"\n        school = schools[\"doubles\"][0]\n        year_group = year_groups[\"doubles\"]\n    \n        import_records_page.navigate_to_class_list_record_import(str(school), year_group)\n>       input_file, _ = import_records_page.upload_and_verify_output(\n            ClassFileMapping.WHITESPACE,\n            programme_group=\"doubles\",\n        )\n\ntests/test_import_class_lists.py:212: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/import_records.py:139: in upload_and_verify_output\n    self.wait_for_processed()\nmavis/test/pages/import_records.py:87: in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npage = <Page url='https://qa.mavistesting.com/class-imports/1165365'>\ntag = <Locator frame=<Frame name= url='https://qa.mavistesting.com/class-imports/1165365'> selector='internal:role=strong >> internal:text=\"Completed\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\"'>\nseconds = 60\n\n    def reload_until_element_is_visible(\n        page: Page, tag: Locator, seconds: int = DEFAULT_TIMEOUT_SECONDS\n    ) -> None:\n        for _ in range(seconds * 2):\n            if tag.is_visible():\n                break\n    \n            time.sleep(0.5)\n    \n            page.reload()\n        else:\n>           expect(tag).to_be_visible()\nE           AssertionError: Locator expected to be visible\nE           Actual value: <element(s) not found> \nE           Call log:\nE             - Expect \"to_be_visible\" with timeout 5000ms\nE             - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\nmavis/test/utils.py:171: AssertionError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":0,"retriesStatusChange":false,"beforeStages":[{"name":"base_url","time":{"start":1761971990152,"stop":1761971990152,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_verify_url","time":{"start":1761971990152,"stop":1761971990152,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_session_faker","time":{"start":1761971990152,"stop":1761971990153,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"onboarding","time":{"start":1761971990154,"stop":1761972006577,"duration":16423},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"year_groups","time":{"start":1761971990154,"stop":1761971990154,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"pytestconfig","time":{"start":1761971990154,"stop":1761971990154,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"programmes_enabled","time":{"start":1761971990154,"stop":1761971990154,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_output_dir","time":{"start":1761971990154,"stop":1761971990154,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"team","time":{"start":1761972006577,"stop":1761972006577,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests","time":{"start":1761972006577,"stop":1761972006577,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"nurse","time":{"start":1761972006577,"stop":1761972006577,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"schools","time":{"start":1761972006578,"stop":1761972006578,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"clinics","time":{"start":1761972006578,"stop":1761972006578,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type_launch_args","time":{"start":1761972006578,"stop":1761972006578,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright","time":{"start":1761972006578,"stop":1761972006871,"duration":293},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"organisation","time":{"start":1761972006578,"stop":1761972006578,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"device","time":{"start":1761972006871,"stop":1761972006871,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"launch_browser","time":{"start":1761972006871,"stop":1761972006871,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_type","time":{"start":1761972006871,"stop":1761972006871,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"connect_options","time":{"start":1761972006871,"stop":1761972006871,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser","time":{"start":1761972006872,"stop":1761972008245,"duration":1373},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder","time":{"start":1761972008245,"stop":1761972008245,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1761972008246,"stop":1761972008247,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_credentials","time":{"start":1761972008247,"stop":1761972008247,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser_context_args","time":{"start":1761972008247,"stop":1761972008247,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"basic_auth_token","time":{"start":1761972008247,"stop":1761972008247,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"reset_before_each_module","time":{"start":1761972349634,"stop":1761972351719,"duration":2085},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"new_context","time":{"start":1761972485560,"stop":1761972485561,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder","time":{"start":1761972485560,"stop":1761972485560,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"output_path","time":{"start":1761972485560,"stop":1761972485560,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"context","time":{"start":1761972485561,"stop":1761972485573,"duration":12},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"page","time":{"start":1761972485573,"stop":1761972485787,"duration":214},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags","time":{"start":1761972485787,"stop":1761972485787,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"flipper_page","time":{"start":1761972485787,"stop":1761972485787,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_page","time":{"start":1761972485788,"stop":1761972485788,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"log_in_as_nurse","time":{"start":1761972485788,"stop":1761972488734,"duration":2946},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1761972485788,"stop":1761972487190,"duration":1402},"status":"passed","steps":[{"name":"Go to log in page","time":{"start":1761972485788,"stop":1761972487190,"duration":1402},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Log in as User(username='susan25@example.com', password='susan25@example.com', role='nurse') and choose team Team(name='Smith-Johnson est. 1844', workgroup='L925R', careplus_venue_code='L925R', email='dmurphy@example.org', phone='+44(0)7700 900 714')","time":{"start":1761972487191,"stop":1761972488734,"duration":1543},"status":"passed","steps":[{"name":"Log in as {1} and choose team {2}","time":{"start":1761972487191,"stop":1761972488734,"duration":1543},"status":"passed","steps":[{"name":"Log in as User(username='susan25@example.com', password='susan25@example.com', role='nurse')","time":{"start":1761972487191,"stop":1761972488690,"duration":1499},"status":"passed","steps":[{"name":"Log in as {1}","time":{"start":1761972487191,"stop":1761972488690,"duration":1499},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='susan25@example.com', password='susan25@example.com', role='nurse'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(User(username='susan25@example.com', password='susan25@example.com', role='nurse'), Team(name='Smith-Johnson est. 1844', workgroup='L925R', careplus_venue_code='L925R', email='dmurphy@example.org', phone='+44(0)7700 900 714'))"}],"shouldDisplayMessage":false,"stepsCount":3,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"dashboard_page","time":{"start":1761972488734,"stop":1761972488734,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"children","time":{"start":1761972488734,"stop":1761972488740,"duration":6},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"test_data","time":{"start":1761972488740,"stop":1761972488741,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"sessions_page","time":{"start":1761972488741,"stop":1761972488741,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"setup_class_list","time":{"start":1761972488741,"stop":1761972494430,"duration":5689},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1761972488741,"stop":1761972489032,"duration":291},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1761972488741,"stop":1761972489032,"duration":291},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on 'HPV' session at School(name='Acorn School', urn='135773', site=None)","time":{"start":1761972489033,"stop":1761972490044,"duration":1011},"status":"passed","steps":[{"name":"Click on {2} session at {1}","time":{"start":1761972489033,"stop":1761972490044,"duration":1011},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(School(name='Acorn School', urn='135773', site=None), 'HPV')"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Go to Edit session page","time":{"start":1761972490053,"stop":1761972491503,"duration":1450},"status":"passed","steps":[{"name":"Go to Edit session page","time":{"start":1761972490053,"stop":1761972491503,"duration":1450},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Go to Change session dates page","time":{"start":1761972491503,"stop":1761972491925,"duration":422},"status":"passed","steps":[{"name":"Go to Change session dates page","time":{"start":1761972491503,"stop":1761972491925,"duration":422},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Continue","time":{"start":1761972492034,"stop":1761972492748,"duration":714},"status":"passed","steps":[{"name":"Click on Continue","time":{"start":1761972492034,"stop":1761972492748,"duration":714},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Save changes","time":{"start":1761972492801,"stop":1761972493757,"duration":956},"status":"passed","steps":[{"name":"Click Save changes","time":{"start":1761972492801,"stop":1761972493757,"duration":956},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1761972493757,"stop":1761972494152,"duration":395},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1761972493757,"stop":1761972494152,"duration":395},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Import Records","time":{"start":1761972494152,"stop":1761972494430,"duration":278},"status":"passed","steps":[{"name":"Click on Import Records","time":{"start":1761972494152,"stop":1761972494430,"duration":278},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":16,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"children_page","time":{"start":1761972494430,"stop":1761972494430,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"import_records_page","time":{"start":1761972494430,"stop":1761972494430,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"testStage":{"description":"\nTest: Upload a class list file with extra whitespace and verify normalization.\nSteps:\n1. Upload a file with whitespace issues.\n2. Navigate to children page.\n3. Verify the list is normalized and imported correctly.\nVerification:\n- Imported list matches expected normalized data.\n","status":"failed","statusMessage":"AssertionError: Locator expected to be visible\nActual value: <element(s) not found> \nCall log:\n  - Expect \"to_be_visible\" with timeout 5000ms\n  - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))","statusTrace":"setup_class_list = None\nschools = {'HPV': [School(name='Acorn School', urn='135773', site=None), School(name='Beverley School', urn='111773', site=None)...ool(name='Oak Lodge School', urn='116637', site=None), School(name='Corby Business Academy', urn='135306', site=None)]}\nimport_records_page = <mavis.test.pages.import_records.ImportRecordsPage object at 0x7f972aeaadd0>\nchildren_page = <mavis.test.pages.children.ChildrenPage object at 0x7f972afeb250>\ndashboard_page = <mavis.test.pages.dashboard.DashboardPage object at 0x7f972b0562b0>\nyear_groups = {'HPV': 10, 'MMR': 1, 'doubles': 10, 'flu': 9}\n\n    @pytest.mark.classlist\n    @pytest.mark.bug\n    def test_class_list_file_upload_whitespace_normalization(\n        setup_class_list,\n        schools,\n        import_records_page,\n        children_page,\n        dashboard_page,\n        year_groups,\n    ):\n        \"\"\"\n        Test: Upload a class list file with extra whitespace and verify normalization.\n        Steps:\n        1. Upload a file with whitespace issues.\n        2. Navigate to children page.\n        3. Verify the list is normalized and imported correctly.\n        Verification:\n        - Imported list matches expected normalized data.\n        \"\"\"\n        school = schools[\"doubles\"][0]\n        year_group = year_groups[\"doubles\"]\n    \n        import_records_page.navigate_to_class_list_record_import(str(school), year_group)\n>       input_file, _ = import_records_page.upload_and_verify_output(\n            ClassFileMapping.WHITESPACE,\n            programme_group=\"doubles\",\n        )\n\ntests/test_import_class_lists.py:212: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \nmavis/test/pages/import_records.py:139: in upload_and_verify_output\n    self.wait_for_processed()\nmavis/test/pages/import_records.py:87: in wait_for_processed\n    reload_until_element_is_visible(self.page, tag, seconds=60)\n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ \n\npage = <Page url='https://qa.mavistesting.com/class-imports/1165365'>\ntag = <Locator frame=<Frame name= url='https://qa.mavistesting.com/class-imports/1165365'> selector='internal:role=strong >> internal:text=\"Completed\"i >> internal:or=\"internal:role=strong >> internal:text=\\\\\"Invalid\\\\\"i\"'>\nseconds = 60\n\n    def reload_until_element_is_visible(\n        page: Page, tag: Locator, seconds: int = DEFAULT_TIMEOUT_SECONDS\n    ) -> None:\n        for _ in range(seconds * 2):\n            if tag.is_visible():\n                break\n    \n            time.sleep(0.5)\n    \n            page.reload()\n        else:\n>           expect(tag).to_be_visible()\nE           AssertionError: Locator expected to be visible\nE           Actual value: <element(s) not found> \nE           Call log:\nE             - Expect \"to_be_visible\" with timeout 5000ms\nE             - waiting for get_by_role(\"strong\").get_by_text(\"Completed\").or_(get_by_role(\"strong\").get_by_text(\"Invalid\"))\n\nmavis/test/utils.py:171: AssertionError","steps":[{"name":"Click on Import Records","time":{"start":1761972494431,"stop":1761972495336,"duration":905},"status":"passed","steps":[{"name":"Click on Import Records","time":{"start":1761972494431,"stop":1761972495336,"duration":905},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Select Class List Records","time":{"start":1761972495337,"stop":1761972495421,"duration":84},"status":"passed","steps":[{"name":"Select Class List Records","time":{"start":1761972495337,"stop":1761972495421,"duration":84},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761972495421,"stop":1761972496067,"duration":646},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761972495421,"stop":1761972496066,"duration":645},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Fill location combobox with 'Sharjah English School'","time":{"start":1761972497550,"stop":1761972497573,"duration":23},"status":"passed","steps":[{"name":"Fill location combobox with {1}","time":{"start":1761972497550,"stop":1761972497573,"duration":23},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"('Sharjah English School',)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761972497617,"stop":1761972498275,"duration":658},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761972497617,"stop":1761972498275,"duration":658},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761972498363,"stop":1761972499220,"duration":857},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761972498363,"stop":1761972499219,"duration":856},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Set input file to PosixPath('working/ClassFileMapping.WHITESPACE20251101044819.csv')","time":{"start":1761972499234,"stop":1761972499291,"duration":57},"status":"passed","steps":[{"name":"Set input file to {1}","time":{"start":1761972499234,"stop":1761972499291,"duration":57},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"args","value":"(PosixPath('working/ClassFileMapping.WHITESPACE20251101044819.csv'),)"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click Continue","time":{"start":1761972500291,"stop":1761972501026,"duration":735},"status":"passed","steps":[{"name":"Click Continue","time":{"start":1761972500291,"stop":1761972501026,"duration":735},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[{"name":"_coverage","value":"'TwoSpace, Tabs, NBSP, ZWJ'"}],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click link with uploaded datetime","time":{"start":1761972501214,"stop":1761972501468,"duration":254},"status":"passed","steps":[{"name":"Click link with uploaded datetime","time":{"start":1761972501214,"stop":1761972501468,"duration":254},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":true,"stepsCount":18,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},"afterStages":[{"name":"setup_class_list::0","time":{"start":1761972610892,"stop":1761972612470,"duration":1578},"status":"passed","steps":[{"name":"Go to dashboard","time":{"start":1761972610892,"stop":1761972611226,"duration":334},"status":"passed","steps":[{"name":"Go to dashboard","time":{"start":1761972610892,"stop":1761972611226,"duration":334},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Manage vaccinations in schools","time":{"start":1761972611226,"stop":1761972611464,"duration":238},"status":"passed","steps":[{"name":"Click on Manage vaccinations in schools","time":{"start":1761972611226,"stop":1761972611464,"duration":238},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"Click on Sessions","time":{"start":1761972611464,"stop":1761972611808,"duration":344},"status":"passed","steps":[{"name":"Click on Sessions","time":{"start":1761972611464,"stop":1761972611808,"duration":344},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":6,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"log_in_as_nurse::0","time":{"start":1761972612472,"stop":1761972613427,"duration":955},"status":"passed","steps":[{"name":"Log out","time":{"start":1761972612472,"stop":1761972613427,"duration":955},"status":"passed","steps":[{"name":"Log out","time":{"start":1761972612472,"stop":1761972613427,"duration":955},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":1,"attachmentsCount":0,"hasContent":true,"attachmentStep":false}],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":2,"attachmentsCount":0,"hasContent":true,"attachmentStep":false},{"name":"new_context::0","time":{"start":1761972613428,"stop":1761972613440,"duration":12},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"set_feature_flags::0","time":{"start":1761972613428,"stop":1761972613428,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_artifacts_recorder::0","time":{"start":1761972613441,"stop":1761972613441,"duration":0},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"_pw_artifacts_folder::0","time":{"start":1761973318201,"stop":1761973318202,"duration":1},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"browser::0","time":{"start":1761973318202,"stop":1761973318301,"duration":99},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"playwright::0","time":{"start":1761973318303,"stop":1761973318314,"duration":11},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false},{"name":"delete_team_after_tests::0","time":{"start":1761973318317,"stop":1761973322655,"duration":4338},"status":"passed","steps":[],"attachments":[],"parameters":[],"shouldDisplayMessage":false,"stepsCount":0,"attachmentsCount":0,"hasContent":false,"attachmentStep":false}],"labels":[{"name":"tag","value":"bug"},{"name":"tag","value":"classlist"},{"name":"parentSuite","value":"tests"},{"name":"suite","value":"test_import_class_lists"},{"name":"host","value":"runnervmf2e7y"},{"name":"thread","value":"6048-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.test_import_class_lists"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[],"hidden":true,"retry":true,"extra":{"categories":[],"tags":["classlist","bug"]},"source":"bc9ea4ad31653ac0.json","parameterValues":[]}